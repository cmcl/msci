<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
<title>CoqIntro</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library CoqIntro</h1>

<div class="code">
</div>

<div class="doc">
<a name="lab59"></a><h1 class="section">Coq for POPL Folk</h1>

<div class="paragraph"> </div>

 A streamlined interactive tutorial on fundamentals of Coq,
    focusing on a minimal set of features needed for developing
    programming language metatheory.

<div class="paragraph"> </div>

    Mostly developed by Aaron Bohannon, with help from Benjamin
    Pierce, Dimitrios Vytiniotis, and Steve Zdancewic.

<div class="paragraph"> </div>

<a name="lab60"></a><h1 class="section">Contents</h1>


<div class="paragraph"> </div>

<ul class="doclist">
<li> Getting Started

</li>
<li> Definitions

</li>
<li> Proofs
<ul class="doclist">
<li>- Working with Implication and Universal Quantification

</li>
<li>- Working with Definitions

</li>
<li>- Working with Conjunction and Disjunction

</li>
<li>- Reasoning by Cases and Induction

</li>
<li>- Working with Existential Quantification

</li>
<li>- Working with Negation

</li>
<li>- Working with Equality

</li>
<li>- Reasoning by Inversion

</li>
<li>- Additional Important Tactics

</li>
<li>- Basic Automation

</li>
<li>- Functions and Conversion

</li>
</ul>

</li>
<li> Solutions to Exercises

</li>
</ul>

<div class="paragraph"> </div>

<a name="lab61"></a><h1 class="section">Getting Started</h1>

<div class="paragraph"> </div>

 To get started...

<div class="paragraph"> </div>

<ul class="doclist">
<li> Install Coq (from the Download page of the main Coq web
       site)

<div class="paragraph"> </div>


</li>
<li> Install an IDE: either CoqIDE (from the same page) or
       Proof General (use Google to find it).

<div class="paragraph"> </div>


</li>
<li> Which should you choose?  Their command sets are similar,
       so basically the trade-offs are simple:
<ul class="doclist">
<li>- Proof General is an extension of Emacs (or XEmacs,
            if you prefer), while CoqIDE uses a simpler
            point-and-click model of editing.

</li>
<li>- PG is pretty easy to install; CoqIDE is very easy
            to install if you can find a pre-built version for
            the OS you are running on but can be a little tricky
            to build from scratch because it has lots of
            dependencies.

<div class="paragraph"> </div>


</li>
</ul>

</li>
<li> Familiarize yourself with the most important commands

<div class="paragraph"> </div>

<ul class="doclist">
<li>- If you are using PG, try this:
<ul class="doclist">
<li>-- Open this file and check that the mode line says
                something like "coq Holes Scripting"

</li>
<li>-- Go down a few pages and do C-C C-return.  Notice
                that the part of the file above the cursor
                changes color (and becomes read-only),
                indicating that it has been sent to Coq.

</li>
<li>-- Come back here and do C-C C-return again

</li>
<li>-- You now know all you really need to navigate in
                this file and send parts of it to Coq, but there
                are some other navigation commands that are
                sometimes more convenient.  To see a couple
                more, do C-C C-n several times and observe the
                result; then do C-C C-u a couple of times and
                observe the result.

<div class="paragraph"> </div>


</li>
</ul>

</li>
<li>- If you are using CoqIDE, try this:
<ul class="doclist">
<li>-- Open this file.

</li>
<li>-- Scroll down a few pages.

</li>
<li>-- Hover the mouse over each the buttons at the top
                of the window; this will make the "tool tips"
                appear so you can see which is which.

</li>
<li>-- Press the "Go to cursor" button.  Observe what
                happens.

</li>
<li>-- Press the forward and backward buttons a few
                times.  Observe.

</li>
<li>-- Scroll back to here again and start reading.

<div class="paragraph"> </div>


</li>
</ul>

</li>
</ul>

</li>
<li> Open the Coq reference manual (from the Documentation
       page of the Coq web site) in a web browser.  Spend 30
       seconds looking over the table of contents to get an idea
       what's there.  (There is no need to actually read
       anything now.)

</li>
</ul>

<div class="paragraph"> </div>

<a name="lab62"></a><h1 class="section">Definitions</h1>

<div class="paragraph"> </div>

 In this file, we will be working with a very simple language
    of expressions over natural numbers and booleans.  First we
    need to define the datatype of terms.

<div class="paragraph"> </div>

    The <span class="inlinecode"><span class="id" type="keyword">Inductive</span></span> keyword defines a new inductive type.  We
    name our new type <span class="inlinecode"><span class="id" type="var">tm</span></span> and declare that <span class="inlinecode"><span class="id" type="var">tm</span></span> lives in the
    sort <span class="inlinecode"><span class="id" type="keyword">Set</span></span>.  Types in <span class="inlinecode"><span class="id" type="keyword">Set</span></span> are datatypes, which can be used
    just like those in standard programming languages.  After
    the inductive definition, the global environment contains
    the name of the newly defined type, along with the names of
    all of the constructors.  Coq also automatically defines a
    few operators for eliminating values of the new type
    (<span class="inlinecode"><span class="id" type="var">tm_rec</span></span>, <span class="inlinecode"><span class="id" type="var">tm_ind</span></span>, etc.); we can ignore these for the time
    being, since we will not need to use them directly.

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Inductive</span> <span class="id" type="var">tm</span> : <span class="id" type="keyword">Set</span> :=<br/>
| <span class="id" type="var">tm_true</span> : <span class="id" type="var">tm</span><br/>
| <span class="id" type="var">tm_false</span> : <span class="id" type="var">tm</span><br/>
| <span class="id" type="var">tm_if</span> : <span class="id" type="var">tm</span> -&gt; <span class="id" type="var">tm</span> -&gt; <span class="id" type="var">tm</span> -&gt; <span class="id" type="var">tm</span><br/>
| <span class="id" type="var">tm_zero</span> : <span class="id" type="var">tm</span><br/>
| <span class="id" type="var">tm_succ</span> : <span class="id" type="var">tm</span> -&gt; <span class="id" type="var">tm</span><br/>
| <span class="id" type="var">tm_pred</span> : <span class="id" type="var">tm</span> -&gt; <span class="id" type="var">tm</span><br/>
| <span class="id" type="var">tm_iszero</span> : <span class="id" type="var">tm</span> -&gt; <span class="id" type="var">tm</span>.<br/>

<br/>
</div>

<div class="doc">
Next, we want to designate some of our <span class="inlinecode"><span class="id" type="var">tm</span></span> expressions as
    "values" in our object language.  Mathematically, the
    property of being a value is a unary relation over <span class="inlinecode"><span class="id" type="var">tm</span></span>s.
    The definition of the unary relation <span class="inlinecode"><span class="id" type="var">value</span></span> will be built
    from the definition of two auxiliary relations: <span class="inlinecode"><span class="id" type="var">bvalue</span></span> for
    the set of boolean values and <span class="inlinecode"><span class="id" type="var">nvalue</span></span> for the set of
    numerical values.

<div class="paragraph"> </div>

    We define n-ary relations in Coq much as we do on paper --
    by giving a set of inference rules that can be used to
    justify the membership of a tuple in the relation.  The
    definition of such an inference system also uses the keyword
    <span class="inlinecode"><span class="id" type="keyword">Inductive</span></span>.  Although this is exactly the same device we
    used to build the set <span class="inlinecode"><span class="id" type="var">tm</span></span>, in this case we want to do
    something slightly different:  we will be using it to
    inductively defining the structures (derivation trees) that
    justify the membership of a tuple in a relation, rather than
    directly defining a set inductively.  These derivation trees
    will need to be given a dependent type in order to ensure
    that only correct derivation trees can be built.  It is
    possible to view their type as a datatype such as <span class="inlinecode"><span class="id" type="var">tm</span></span>;
    however, it is more natural to interpret it as a
    proposition, so it will be declared to live in <span class="inlinecode"><span class="id" type="keyword">Prop</span></span>
    instead of <span class="inlinecode"><span class="id" type="keyword">Set</span></span>.  <span class="inlinecode"><span class="id" type="keyword">Prop</span></span> is parallel to <span class="inlinecode"><span class="id" type="keyword">Set</span></span> in the sort
    hierarchy, but types in <span class="inlinecode"><span class="id" type="keyword">Prop</span></span> can be thought of as logical
    propositions rather than datatypes.  The inhabitants of
    types in <span class="inlinecode"><span class="id" type="keyword">Prop</span></span> can be thought of as proofs rather than
    programs.

<div class="paragraph"> </div>

    The unary relations <span class="inlinecode"><span class="id" type="var">bvalue</span></span> and <span class="inlinecode"><span class="id" type="var">nvalue</span></span> are defined by
    very simple inference systems, each having just two rules.
    After defining these inference systems, <span class="inlinecode"><span class="id" type="var">bvalue</span></span> and
    <span class="inlinecode"><span class="id" type="var">nvalue</span></span> will each be a family of types indexed by elements
    of <span class="inlinecode"><span class="id" type="var">tm</span></span>.  We can build inhabitants of some (but not all) of
    the types in these families with the constructors from our
    inductive definition.  Semantically, we consider the
    proposition <span class="inlinecode"><span class="id" type="var">bvalue</span></span> <span class="inlinecode"><span class="id" type="var">t</span></span> to be true if it is inhabited and
    false if it is not.  (It is worth noting at this point that,
    by default, Coq's logic is constructive and <span class="inlinecode"><span class="id" type="var">P</span></span> <span class="inlinecode">\/</span> <span class="inlinecode"><span class="id" type="var">not</span></span> <span class="inlinecode"><span class="id" type="var">P</span></span> is
    provable for some <span class="inlinecode"><span class="id" type="var">P</span></span> but not for others.  However, it is
    sound to add the law of the excluded middle as an axiom, if
    desired.)

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Inductive</span> <span class="id" type="var">bvalue</span> : <span class="id" type="var">tm</span> -&gt; <span class="id" type="keyword">Prop</span> :=<br/>
| <span class="id" type="var">b_true</span> : <span class="id" type="var">bvalue</span> <span class="id" type="var">tm_true</span><br/>
| <span class="id" type="var">b_false</span> : <span class="id" type="var">bvalue</span> <span class="id" type="var">tm_false</span>.<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <span class="id" type="var">nvalue</span> : <span class="id" type="var">tm</span> -&gt; <span class="id" type="keyword">Prop</span> :=<br/>
| <span class="id" type="var">n_zero</span> : <span class="id" type="var">nvalue</span> <span class="id" type="var">tm_zero</span><br/>
| <span class="id" type="var">n_succ</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">nvalue</span> <span class="id" type="var">t</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">nvalue</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span>).<br/>

<br/>
</div>

<div class="doc">
The <span class="inlinecode"><span class="id" type="keyword">Definition</span></span> keyword is used for defining non-recursive
    functions (including 0-ary functions, i.e., constants).
    Here we define the unary predicate <span class="inlinecode"><span class="id" type="var">value</span></span> using disjunction
    on propositions (written <span class="inlinecode">\/</span>).

<div class="paragraph"> </div>

    Note: It is not actually necessary to provide the types of
    the arguments nor the return type when they can easily be
    inferred; for example, the annotations <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" type="var">tm</span></span> and <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" type="keyword">Prop</span></span>
    are optional here.

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">value</span> (<span class="id" type="var">t</span> : <span class="id" type="var">tm</span>) : <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="var">bvalue</span> <span class="id" type="var">t</span> \/ <span class="id" type="var">nvalue</span> <span class="id" type="var">t</span>.<br/>

<br/>
</div>

<div class="doc">
Having defined <span class="inlinecode"><span class="id" type="var">tm</span></span>s and <span class="inlinecode"><span class="id" type="var">value</span></span>s, we can define a
    call-by-value operational semantics of our language by
    giving a definition of the single-step evaluation of one
    term to another.  We give this as an inductively defined
    binary relation.

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Inductive</span> <span class="id" type="tactic">eval</span> : <span class="id" type="var">tm</span> -&gt; <span class="id" type="var">tm</span> -&gt; <span class="id" type="keyword">Prop</span> :=<br/>
| <span class="id" type="var">e_iftrue</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eval</span> (<span class="id" type="var">tm_if</span> <span class="id" type="var">tm_true</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>) <span class="id" type="var">t2</span><br/>
| <span class="id" type="var">e_iffalse</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eval</span> (<span class="id" type="var">tm_if</span> <span class="id" type="var">tm_false</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>) <span class="id" type="var">t3</span><br/>
| <span class="id" type="var">e_if</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t1</span> <span class="id" type="var">t1'</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t1</span> <span class="id" type="var">t1'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eval</span> (<span class="id" type="var">tm_if</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>) (<span class="id" type="var">tm_if</span> <span class="id" type="var">t1'</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>)<br/>
| <span class="id" type="var">e_succ</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eval</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span>) (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t'</span>)<br/>
| <span class="id" type="var">e_predzero</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eval</span> (<span class="id" type="var">tm_pred</span> <span class="id" type="var">tm_zero</span>) <span class="id" type="var">tm_zero</span><br/>
| <span class="id" type="var">e_predsucc</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">nvalue</span> <span class="id" type="var">t</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eval</span> (<span class="id" type="var">tm_pred</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span>)) <span class="id" type="var">t</span><br/>
| <span class="id" type="var">e_pred</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eval</span> (<span class="id" type="var">tm_pred</span> <span class="id" type="var">t</span>) (<span class="id" type="var">tm_pred</span> <span class="id" type="var">t'</span>)<br/>
| <span class="id" type="var">e_iszerozero</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eval</span> (<span class="id" type="var">tm_iszero</span> <span class="id" type="var">tm_zero</span>) <span class="id" type="var">tm_true</span><br/>
| <span class="id" type="var">e_iszerosucc</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">nvalue</span> <span class="id" type="var">t</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eval</span> (<span class="id" type="var">tm_iszero</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span>)) <span class="id" type="var">tm_false</span><br/>
| <span class="id" type="var">e_iszero</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eval</span> (<span class="id" type="var">tm_iszero</span> <span class="id" type="var">t</span>) (<span class="id" type="var">tm_iszero</span> <span class="id" type="var">t'</span>).<br/>

<br/>
</div>

<div class="doc">
We define multi-step evaluation with the relation
    <span class="inlinecode"><span class="id" type="var">eval_many</span></span>.  This relation includes all of the pairs of
    terms that are connected by sequences of evaluation steps.

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Inductive</span> <span class="id" type="var">eval_many</span> : <span class="id" type="var">tm</span> -&gt; <span class="id" type="var">tm</span> -&gt; <span class="id" type="keyword">Prop</span> :=<br/>
| <span class="id" type="var">m_refl</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">t</span><br/>
| <span class="id" type="var">m_step</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span class="id" type="var">u</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t'</span> <span class="id" type="var">u</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab63"></a><h3 class="section">Exercise</h3>

    Multi-step evaluation is often defined as the "reflexive,
    transitive closure" of single-step evaluation.  Write an
    inductively defined relation <span class="inlinecode"><span class="id" type="var">eval_rtc</span></span> that corresponds to
    that verbal description.

<div class="paragraph"> </div>

    In case you get stuck or need a hint, you can find solutions
    to all the exercises near the bottom of the file.

<div class="paragraph"> </div>

 A term is a <span class="inlinecode"><span class="id" type="var">normal_form</span></span> if there is no term to which it
    can step.  Note the concrete syntax for negation and
    existential quantification in the definition below.

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">normal_form</span> (<span class="id" type="var">t</span> : <span class="id" type="var">tm</span>) : <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;~ <span class="id" type="tactic">exists</span> <span class="id" type="var">t'</span>, <span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab64"></a><h3 class="section">Exercise</h3>

    Sometimes it is more convenient to use a big-step semantics
    for a language.  Add the remaining constructors to finish
    the inductive definition <span class="inlinecode"><span class="id" type="var">full_eval</span></span> for the big-step
    semantics that corresponds to the small-step semantics
    defined by <span class="inlinecode"><span class="id" type="tactic">eval</span></span>.  Build the inference rules so that
    <span class="inlinecode"><span class="id" type="var">full_eval</span></span> <span class="inlinecode"><span class="id" type="var">t</span></span> <span class="inlinecode"><span class="id" type="var">v</span></span> logically implies both <span class="inlinecode"><span class="id" type="var">eval_many</span></span> <span class="inlinecode"><span class="id" type="var">t</span></span> <span class="inlinecode"><span class="id" type="var">v</span></span> and
    <span class="inlinecode"><span class="id" type="var">value</span></span> <span class="inlinecode"><span class="id" type="var">v</span></span>.  In order to do this, you may need to add the
    premise <span class="inlinecode"><span class="id" type="var">nvalue</span></span> <span class="inlinecode"><span class="id" type="var">v</span></span> to the appropriate cases.

<div class="paragraph"> </div>

    Hint: You should end up with a total of 8 cases.

<div class="paragraph"> </div>

<pre>
Inductive full_eval : tm -&gt; tm -&gt; Prop :=
| f_value : forall v,
    value v -&gt;
    full_eval v v
| f_iftrue : forall t1 t2 t3 v,
    full_eval t1 tm_true -&gt;
    full_eval t2 v -&gt;
    full_eval (tm_if t1 t2 t3) v
| f_succ : forall t v,
    nvalue v -&gt;
    full_eval t v -&gt;
    full_eval (tm_succ t) (tm_succ v).
</pre>

<div class="paragraph"> </div>

<a name="lab65"></a><h3 class="section">Tip</h3>

    If you want to see the type of an identifier <span class="inlinecode"><span class="id" type="var">x</span></span>, you can
    use the command <span class="inlinecode"><span class="id" type="keyword">Check</span></span> <span class="inlinecode"><span class="id" type="var">x</span>.</span>  If you want to see the
    definition of an identifier <span class="inlinecode"><span class="id" type="var">x</span></span>, you can use the command
    <span class="inlinecode"><span class="id" type="keyword">Print</span></span> <span class="inlinecode"><span class="id" type="var">x</span>.</span>

</div>
<div class="code">
<span class="id" type="keyword">Check</span> <span class="id" type="var">tm_if</span>.<br/>
<span class="id" type="keyword">Check</span> <span class="id" type="var">m_step</span>.<br/>
<span class="id" type="keyword">Check</span> <span class="id" type="var">value</span>.<br/>
<span class="id" type="keyword">Print</span> <span class="id" type="var">value</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab66"></a><h1 class="section">Proofs</h1>

<div class="paragraph"> </div>

 A proposition and its proof are both represented as terms in
    the calculus of inductive constructions, which is
    syntactically very small.

<div class="paragraph"> </div>

    Proof terms are most easily built interactively, using
    tactics to manipulate a proof state.  A proof state consists
    of a set of goals (propositions or types for which you must
    produce an inhabitant), each with a context of hypotheses
    (inhabitants of propositions or types you are allowed to
    use).  A proof state begins initially with one goal (the
    statement of the lemma you are tying to prove) and no
    hypotheses.  A goal can be solved, and thereby eliminated,
    when it exactly matches one of hypotheses in the context.  A
    proof is completed when all goals are solved.

<div class="paragraph"> </div>

    Tactics can be used for forward reasoning (which, roughly
    speaking, means modifying the hypotheses of a context while
    leaving the goal unchanged) or backward reasoning (replacing
    the current goal with one or more new goals in simpler
    contexts).  Given the level of detail required in a formal
    proof, it would be ridiculously impractical to complete a
    proof using forward reasoning alone.  However it is usually
    both possible and practical to complete a proof using
    backward reasoning alone.  Therefore, we focus almost
    exclusively on backward reasoning in this tutorial.  Of
    course, most people naturally use a significant amount of
    forward reasoning in their thinking process, so it may take
    you a while to become accustomed to getting by without it.

<div class="paragraph"> </div>

    We use the keyword <span class="inlinecode"><span class="id" type="keyword">Lemma</span></span> to state a new proposition we
    wish to prove.  (<span class="inlinecode"><span class="id" type="keyword">Theorem</span></span> and <span class="inlinecode"><span class="id" type="keyword">Fact</span></span> are exact synonyms for
    <span class="inlinecode"><span class="id" type="keyword">Lemma</span></span>.)  The keyword <span class="inlinecode"><span class="id" type="keyword">Proof</span></span>, immediately following the
    statement of the proposition, indicates the beginning of a
    proof script.  A proof script is a sequence of tactic
    expressions, each concluding with a "<span class="inlinecode">.</span>".  Once all of the
    goals are solved, we use the keyword <span class="inlinecode"><span class="id" type="keyword">Qed</span></span> to record the
    completed proof.  If the proof is incomplete, we may tell
    Coq to accept the lemma on faith by using <span class="inlinecode"><span class="id" type="var">Admitted</span></span> instead
    of <span class="inlinecode"><span class="id" type="keyword">Qed</span></span>.

<div class="paragraph"> </div>

    We now proceed to introduce the specific proof tactics.

<div class="paragraph"> </div>

<a name="lab67"></a><h2 class="section">Working with Implication and Universal Quantification</h2>


<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" type="tactic">intros</span></span>

</li>
<li> <span class="inlinecode"><span class="id" type="tactic">apply</span></span>

</li>
<li> <span class="inlinecode"><span class="id" type="tactic">apply</span></span> <span class="inlinecode"><span class="id" type="keyword">with</span></span> <span class="inlinecode">(<span class="id" type="var">x</span></span> <span class="inlinecode">:=</span> <span class="inlinecode">...)</span>

</li>
</ul>

<div class="paragraph"> </div>

<a name="lab68"></a><h3 class="section">Example</h3>

    The tactic <span class="inlinecode"><span class="id" type="tactic">intros</span></span> <span class="inlinecode"><span class="id" type="var">x1</span></span> <span class="inlinecode">...</span> <span class="inlinecode"><span class="id" type="var">xn</span></span> moves antecedents and
    universally quantified variables from the goal into the
    context as hypotheses.  The tactic <span class="inlinecode"><span class="id" type="tactic">apply</span></span> is complementary
    to <span class="inlinecode"><span class="id" type="tactic">intros</span></span>.  If the conclusion (the part following the
    rightmost arrow) of a constructor, hypothesis, or lemma <span class="inlinecode"><span class="id" type="var">e</span></span>
    matches our current goal, then <span class="inlinecode"><span class="id" type="tactic">apply</span></span> <span class="inlinecode"><span class="id" type="var">e</span></span> will replace the
    goal with a new goal for each premise/antecedent of <span class="inlinecode"><span class="id" type="var">e</span></span>.  If
    <span class="inlinecode"><span class="id" type="var">e</span></span> has no premises, then the current goal is solved.  Using
    <span class="inlinecode"><span class="id" type="tactic">apply</span></span> allows us to build a proof tree from the bottom up.
    In the following example, our proof script will effectively
    build the following proof tree:

<div class="paragraph"> </div>

<pre>
                        nvalue t
             ---------------------------- (e_predsucc)
             eval (tm_pred (tm_succ t)) t
    ------------------------------------------------ (e_succ)
    eval (tm_succ (tm_pred (tm_succ t))) (tm_succ t)
</pre>

<div class="paragraph"> </div>

    Step through the proof to see how this tree is constructed.
    For each tactic, we give the corresponding statement in a
    written proof.  (The uses of <span class="inlinecode"><span class="id" type="keyword">Check</span></span> are inessential.)

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">e_succ_pred_succ</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">nvalue</span> <span class="id" type="var">t</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> (<span class="id" type="var">tm_succ</span> (<span class="id" type="var">tm_pred</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span>))) (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
</div>

<div class="doc">
Let <span class="inlinecode"><span class="id" type="var">t</span></span> be a <span class="inlinecode"><span class="id" type="var">tm</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span>.<br/>

<br/>
</div>

<div class="doc">
Assume that <span class="inlinecode"><span class="id" type="var">t</span></span> is an <span class="inlinecode"><span class="id" type="var">nvalue</span></span> (and let's call that
      assumption <span class="inlinecode"><span class="id" type="var">Hn</span></span> for future reference). 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Hn</span>.<br/>

<br/>
</div>

<div class="doc">
By <span class="inlinecode"><span class="id" type="var">e_succ</span></span>, in order to prove our conclusion, it suffices
      to prove that <span class="inlinecode"><span class="id" type="tactic">eval</span></span> <span class="inlinecode">(<span class="id" type="var">tm_pred</span></span> <span class="inlinecode">(<span class="id" type="var">tm_succ</span></span> <span class="inlinecode"><span class="id" type="var">t</span>))</span> <span class="inlinecode"><span class="id" type="var">t</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="keyword">Check</span> <span class="id" type="var">e_succ</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">e_succ</span>.<br/>

<br/>
</div>

<div class="doc">
That, in turn, can be shown by <span class="inlinecode"><span class="id" type="var">e_predsucc</span></span>, if we are
      able to show that <span class="inlinecode"><span class="id" type="var">nvalue</span></span> <span class="inlinecode"><span class="id" type="var">t</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="keyword">Check</span> <span class="id" type="var">e_predsucc</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">e_predsucc</span>.<br/>

<br/>
</div>

<div class="doc">
But, in fact, we assumed <span class="inlinecode"><span class="id" type="var">nvalue</span></span> <span class="inlinecode"><span class="id" type="var">t</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Hn</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab69"></a><h3 class="section">Hint for PG users</h3>

    If you place the cursor after <span class="inlinecode"><span class="id" type="keyword">Proof</span>.</span> and do C-c C-return,
    you'll notice that the window displaying Coq's responses is
    (annoyingly) empty, instead of showing what is to be proved.
    The reason for this is that, actually, a different buffer is
    being displayed!  (To see this, do C-c C-n and C-c C-u a few
    times and notice that the buffer name in the mode line
    changes.)  You can use C-c C-p to switch the display back
    from the *response* buffer to the *goals* buffer.

<div class="paragraph"> </div>

<a name="lab70"></a><h3 class="section">Example</h3>

    Now consider, for a moment, the rule <span class="inlinecode"><span class="id" type="var">m_step</span></span>:

<div class="paragraph"> </div>

<pre>
    eval t t'  eval_many t' u
    ------------------------- (m_step)
          eval_many t u
</pre>

<div class="paragraph"> </div>

    If we have a goal such as <span class="inlinecode"><span class="id" type="var">eval_many</span></span> <span class="inlinecode"><span class="id" type="var">e1</span></span> <span class="inlinecode"><span class="id" type="var">e2</span></span>, we should be
    able to use <span class="inlinecode"><span class="id" type="tactic">apply</span></span> <span class="inlinecode"><span class="id" type="var">m_step</span></span> in order to replace it with the
    goals <span class="inlinecode"><span class="id" type="tactic">eval</span></span> <span class="inlinecode"><span class="id" type="var">e1</span></span> <span class="inlinecode"><span class="id" type="var">t'</span></span> and <span class="inlinecode"><span class="id" type="var">eval_many</span></span> <span class="inlinecode"><span class="id" type="var">t'</span></span> <span class="inlinecode"><span class="id" type="var">e2</span></span>.  But what exactly
    is <span class="inlinecode"><span class="id" type="var">t'</span></span> here?  When and how is it chosen?  It stands to
    reason the conclusion is justified if we can come up with
    any <span class="inlinecode"><span class="id" type="var">t'</span></span> for which the premises can be justified.

<div class="paragraph"> </div>

    Now we note that, in the Coq syntax for the type of
    <span class="inlinecode"><span class="id" type="var">m_step</span></span>, all three variables <span class="inlinecode"><span class="id" type="var">t</span></span>, <span class="inlinecode"><span class="id" type="var">t'</span></span>, and <span class="inlinecode"><span class="id" type="var">u</span></span> are
    universally quantified.  The tactic <span class="inlinecode"><span class="id" type="tactic">apply</span></span> <span class="inlinecode"><span class="id" type="var">m_step</span></span> will use
    pattern matching between our goal and the conclusion of
    <span class="inlinecode"><span class="id" type="var">m_step</span></span> to find the only possible instantiation of <span class="inlinecode"><span class="id" type="var">t</span></span> and
    <span class="inlinecode"><span class="id" type="var">u</span></span>.  However, <span class="inlinecode"><span class="id" type="tactic">apply</span></span> <span class="inlinecode"><span class="id" type="var">m_step</span></span> will raise an error since it
    does not know how it should instantiate <span class="inlinecode"><span class="id" type="var">t'</span></span>.  In this case,
    the <span class="inlinecode"><span class="id" type="tactic">apply</span></span> tactic takes a <span class="inlinecode"><span class="id" type="keyword">with</span></span> clause that allows us to
    provide this instantiation.  This is demonstrated in the
    proof below.  (Note that the use of this feature means that
    our proof scripts are not invariant under alpha-equivalence
    on the types of our constructors and lemmas.  If this is a
    concern, there are other means of achieving the same result
    in a way that is compatible with alpha-conversion.  See the
    next example.)

<div class="paragraph"> </div>

    Observe how this works in the proof script below.  The proof
    tree here gives a visual representation of the proof term we
    are going to construct and the proof script has again been
    annotated with the steps in English.

<div class="paragraph"> </div>

<pre>
    Letting   s = tm_succ
              p = tm_pred
            lem = e_succ_pred_succ,

            nvalue t
    - - - - - - - - - - - - (lem) --------------------- (m_refl)
    eval (s (p (s t))) (s t)      eval_many (s t) (s t)
    --------------------------------------------------- (m_step)
                eval_many (s (p (s t))) (s t)
</pre>

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">m_succ_pred_succ</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">nvalue</span> <span class="id" type="var">t</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> (<span class="id" type="var">tm_succ</span> (<span class="id" type="var">tm_pred</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span>))) (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
</div>

<div class="doc">
Let <span class="inlinecode"><span class="id" type="var">t</span></span> be a <span class="inlinecode"><span class="id" type="var">tm</span></span>, and assume <span class="inlinecode"><span class="id" type="var">nvalue</span></span> <span class="inlinecode"><span class="id" type="var">t</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">Hn</span>.<br/>

<br/>
</div>

<div class="doc">
By <span class="inlinecode"><span class="id" type="var">m_step</span></span>, to show our conclusion, it suffices to find
      some <span class="inlinecode"><span class="id" type="var">t'</span></span> for which
        <span class="inlinecode"><span class="id" type="tactic">eval</span></span> <span class="inlinecode">(<span class="id" type="var">tm_succ</span></span> <span class="inlinecode">(<span class="id" type="var">tm_pred</span></span> <span class="inlinecode">(<span class="id" type="var">tm_succ</span></span> <span class="inlinecode"><span class="id" type="var">t</span>)))</span> <span class="inlinecode"><span class="id" type="var">t'</span></span>
      and
        <span class="inlinecode"><span class="id" type="tactic">eval</span></span> <span class="inlinecode"><span class="id" type="var">t'</span></span> <span class="inlinecode">(<span class="id" type="var">tm_succ</span></span> <span class="inlinecode"><span class="id" type="var">t</span>)</span>.
      Let us choose <span class="inlinecode"><span class="id" type="var">t'</span></span> to be <span class="inlinecode"><span class="id" type="var">tm_succ</span></span> <span class="inlinecode"><span class="id" type="var">t</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" type="keyword">Check</span> <span class="id" type="var">m_step</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_step</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">t'</span> := <span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span>).<br/>

<br/>
</div>

<div class="doc">
By the lemma <span class="inlinecode"><span class="id" type="var">e_succ_pred_succ</span></span>, to show
          <span class="inlinecode"><span class="id" type="tactic">eval</span></span> <span class="inlinecode">(<span class="id" type="var">tm_succ</span></span> <span class="inlinecode">(<span class="id" type="var">tm_pred</span></span> <span class="inlinecode">(<span class="id" type="var">tm_succ</span></span> <span class="inlinecode"><span class="id" type="var">t</span>)))</span> <span class="inlinecode">(<span class="id" type="var">tm_succ</span></span> <span class="inlinecode"><span class="id" type="var">t</span>)</span>,
        it suffices to show <span class="inlinecode"><span class="id" type="var">nvalue</span></span> <span class="inlinecode"><span class="id" type="var">t</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Check</span> <span class="id" type="var">e_succ_pred_succ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">e_succ_pred_succ</span>.<br/>

<br/>
</div>

<div class="doc">
And, in fact, we assumed <span class="inlinecode"><span class="id" type="var">nvalue</span></span> <span class="inlinecode"><span class="id" type="var">t</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Hn</span>.<br/>

<br/>
</div>

<div class="doc">
Moreover, by the rule <span class="inlinecode"><span class="id" type="var">m_refl</span></span>, we also may conclude
        <span class="inlinecode"><span class="id" type="tactic">eval</span></span> <span class="inlinecode">(<span class="id" type="var">tm_succ</span></span> <span class="inlinecode"><span class="id" type="var">t</span>)</span> <span class="inlinecode">(<span class="id" type="var">tm_succ</span></span> <span class="inlinecode"><span class="id" type="var">t</span>)</span>. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Check</span> <span class="id" type="var">m_refl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_refl</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab71"></a><h3 class="section">Example</h3>

    Coq is built around the Curry-Howard correspondence.
    Proofs of universally quantified propositions are functions
    that take the witness of the quantifier as an argument.
    Similarly, proofs of implications are functions that take
    one proof as an argument and return another proof.  Observe
    the types of the following terms.

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Check</span> (<span class="id" type="var">e_succ_pred_succ</span>).<br/>
<span class="id" type="keyword">Check</span> (<span class="id" type="var">e_succ_pred_succ</span> <span class="id" type="var">tm_zero</span>).<br/>
<span class="id" type="keyword">Check</span> (<span class="id" type="var">n_zero</span>).<br/>
<span class="id" type="keyword">Check</span> (<span class="id" type="var">e_succ_pred_succ</span> <span class="id" type="var">tm_zero</span> <span class="id" type="var">n_zero</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab72"></a><h3 class="section">Example</h3>

    Any tactic like <span class="inlinecode"><span class="id" type="tactic">apply</span></span> that takes the name of a constructor
    or lemma as an argument can just as easily be given a more
    complicated expression as an argument.  Thus, we may use
    function application to construct proof objects on the fly
    in these cases.  Observe how this technique can be used to
    rewrite the proof of the previous lemma.

<div class="paragraph"> </div>

    Although, we have eliminated one use of <span class="inlinecode"><span class="id" type="tactic">apply</span></span>, this is not
    necessarily an improvement over the previous proof.
    However, there are cases where this technique is quite
    valuable.

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">m_succ_pred_succ_alt</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">nvalue</span> <span class="id" type="var">t</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> (<span class="id" type="var">tm_succ</span> (<span class="id" type="var">tm_pred</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span>))) (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">Hn</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Check</span> <span class="id" type="var">m_step</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> (<span class="id" type="var">m_step</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">tm_succ</span> (<span class="id" type="var">tm_pred</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Check</span> <span class="id" type="var">e_succ_pred_succ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> (<span class="id" type="var">e_succ_pred_succ</span> <span class="id" type="var">t</span> <span class="id" type="var">Hn</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Check</span> <span class="id" type="var">m_refl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> (<span class="id" type="var">m_refl</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span>)).<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab73"></a><h3 class="section">Hint for PG users</h3>

    By default, the "." key is "electric" -- it inserts a period
    <i>and</i> causes the material up to the cursor to be sent to
    Coq.  If you find this behavior annoying, it can be toggled
    by doing "C-c .".

</div>
<div class="code">

<br/>

<br/>
</div>

<div class="doc">
<a name="lab74"></a><h3 class="section">Exercise</h3>

    Write a proof script to prove the following lemma, based
    upon the proof given in English.

<div class="paragraph"> </div>

    Note: The lemma and the next should be useful in later
    proofs.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">m_one</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
</div>

<div class="doc">
Let <span class="inlinecode"><span class="id" type="var">t1</span></span> and <span class="inlinecode"><span class="id" type="var">t2</span></span> be terms, and assume <span class="inlinecode"><span class="id" type="tactic">eval</span></span> <span class="inlinecode"><span class="id" type="var">t1</span></span> <span class="inlinecode"><span class="id" type="var">t2</span></span>.  We
      may conclude <span class="inlinecode"><span class="id" type="var">eval_many</span></span> <span class="inlinecode"><span class="id" type="var">t1</span></span> <span class="inlinecode"><span class="id" type="var">t2</span></span> by <span class="inlinecode"><span class="id" type="var">m_step</span></span> if we can find
      a term <span class="inlinecode"><span class="id" type="var">t'</span></span> such that <span class="inlinecode"><span class="id" type="tactic">eval</span></span> <span class="inlinecode"><span class="id" type="var">t1</span></span> <span class="inlinecode"><span class="id" type="var">t'</span></span> and <span class="inlinecode"><span class="id" type="var">eval_many</span></span> <span class="inlinecode"><span class="id" type="var">t'</span></span> <span class="inlinecode"><span class="id" type="var">t2</span></span>.
      We will choose <span class="inlinecode"><span class="id" type="var">t'</span></span> to be <span class="inlinecode"><span class="id" type="var">t2</span></span>.  Now we can show
      <span class="inlinecode"><span class="id" type="tactic">eval</span></span> <span class="inlinecode"><span class="id" type="var">t1</span></span> <span class="inlinecode"><span class="id" type="var">t2</span></span> by our assumption, and we can show
      <span class="inlinecode"><span class="id" type="var">eval_many</span></span> <span class="inlinecode"><span class="id" type="var">t2</span></span> <span class="inlinecode"><span class="id" type="var">t2</span></span> by <span class="inlinecode"><span class="id" type="var">m_refl</span></span>. 
</div>
<div class="code">

<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab75"></a><h3 class="section">Exercise</h3>

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">m_two</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>,<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t1</span> <span class="id" type="var">t3</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
</div>

<div class="doc">
Let <span class="inlinecode"><span class="id" type="var">t1</span></span>, <span class="inlinecode"><span class="id" type="var">t2</span></span>, and <span class="inlinecode"><span class="id" type="var">t3</span></span> be terms.  Assume <span class="inlinecode"><span class="id" type="tactic">eval</span></span> <span class="inlinecode"><span class="id" type="var">t1</span></span> <span class="inlinecode"><span class="id" type="var">t2</span></span>
      and <span class="inlinecode"><span class="id" type="tactic">eval</span></span> <span class="inlinecode"><span class="id" type="var">t2</span></span> <span class="inlinecode"><span class="id" type="var">t3</span></span>.  By <span class="inlinecode"><span class="id" type="var">m_step</span></span>, we may conclude that
      <span class="inlinecode"><span class="id" type="var">eval_many</span></span> <span class="inlinecode"><span class="id" type="var">t1</span></span> <span class="inlinecode"><span class="id" type="var">t3</span></span> if we can find a term <span class="inlinecode"><span class="id" type="var">t'</span></span> such that
      <span class="inlinecode"><span class="id" type="tactic">eval</span></span> <span class="inlinecode"><span class="id" type="var">t1</span></span> <span class="inlinecode"><span class="id" type="var">t'</span></span> and <span class="inlinecode"><span class="id" type="var">eval_many</span></span> <span class="inlinecode"><span class="id" type="var">t'</span></span> <span class="inlinecode"><span class="id" type="var">t3</span></span>.  Let's choose <span class="inlinecode"><span class="id" type="var">t'</span></span> to
      be <span class="inlinecode"><span class="id" type="var">t2</span></span>.  We know <span class="inlinecode"><span class="id" type="tactic">eval</span></span> <span class="inlinecode"><span class="id" type="var">t1</span></span> <span class="inlinecode"><span class="id" type="var">t2</span></span> holds by assumption.  In
      the other case, by the lemma <span class="inlinecode"><span class="id" type="var">m_one</span></span>, to show <span class="inlinecode"><span class="id" type="var">eval_many</span></span>
      <span class="inlinecode"><span class="id" type="var">t2</span></span> <span class="inlinecode"><span class="id" type="var">t3</span></span>, it suffices to show <span class="inlinecode"><span class="id" type="tactic">eval</span></span> <span class="inlinecode"><span class="id" type="var">t2</span></span> <span class="inlinecode"><span class="id" type="var">t3</span></span>, which is one of
      our assumptions.  
</div>
<div class="code">

<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab76"></a><h3 class="section">Exercise</h3>

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">m_iftrue_step</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">u</span>,<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">tm_true</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t1</span> <span class="id" type="var">u</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> (<span class="id" type="var">tm_if</span> <span class="id" type="var">t</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>) <span class="id" type="var">u</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
</div>

<div class="doc">
Let <span class="inlinecode"><span class="id" type="var">t</span></span>, <span class="inlinecode"><span class="id" type="var">t1</span></span>, <span class="inlinecode"><span class="id" type="var">t2</span></span>, and <span class="inlinecode"><span class="id" type="var">u</span></span> be terms.  Assume that
      <span class="inlinecode"><span class="id" type="tactic">eval</span></span> <span class="inlinecode"><span class="id" type="var">t</span></span> <span class="inlinecode"><span class="id" type="var">tm_true</span></span> and <span class="inlinecode"><span class="id" type="var">eval_many</span></span> <span class="inlinecode"><span class="id" type="var">t1</span></span> <span class="inlinecode"><span class="id" type="var">u</span></span>.  To show
      <span class="inlinecode"><span class="id" type="var">eval_many</span></span> <span class="inlinecode">(<span class="id" type="var">tm_if</span></span> <span class="inlinecode"><span class="id" type="var">t</span></span> <span class="inlinecode"><span class="id" type="var">t1</span></span> <span class="inlinecode"><span class="id" type="var">t2</span>)</span> <span class="inlinecode"><span class="id" type="var">u</span></span>, by <span class="inlinecode"><span class="id" type="var">m_step</span></span>, it suffices to
      find a <span class="inlinecode"><span class="id" type="var">t'</span></span> for which <span class="inlinecode"><span class="id" type="tactic">eval</span></span> <span class="inlinecode">(<span class="id" type="var">tm_if</span></span> <span class="inlinecode"><span class="id" type="var">t</span></span> <span class="inlinecode"><span class="id" type="var">t1</span></span> <span class="inlinecode"><span class="id" type="var">t2</span>)</span> <span class="inlinecode"><span class="id" type="var">t'</span></span> and
      <span class="inlinecode"><span class="id" type="var">eval_many</span></span> <span class="inlinecode"><span class="id" type="var">t'</span></span> <span class="inlinecode"><span class="id" type="var">u</span></span>.  Let us choose <span class="inlinecode"><span class="id" type="var">t'</span></span> to be
      <span class="inlinecode"><span class="id" type="var">tm_if</span></span> <span class="inlinecode"><span class="id" type="var">tm_true</span></span> <span class="inlinecode"><span class="id" type="var">t1</span></span> <span class="inlinecode"><span class="id" type="var">t2</span></span>.  Now we can use <span class="inlinecode"><span class="id" type="var">e_if</span></span> to show that
      <span class="inlinecode"><span class="id" type="tactic">eval</span></span> <span class="inlinecode">(<span class="id" type="var">tm_if</span></span> <span class="inlinecode"><span class="id" type="var">t</span></span> <span class="inlinecode"><span class="id" type="var">t1</span></span> <span class="inlinecode"><span class="id" type="var">t2</span>)</span> <span class="inlinecode">(<span class="id" type="var">tm_if</span></span> <span class="inlinecode"><span class="id" type="var">tm_true</span></span> <span class="inlinecode"><span class="id" type="var">t1</span></span> <span class="inlinecode"><span class="id" type="var">t2</span>)</span> if we can
      show <span class="inlinecode"><span class="id" type="tactic">eval</span></span> <span class="inlinecode"><span class="id" type="var">t</span></span> <span class="inlinecode"><span class="id" type="var">tm_true</span></span>, which is actually one of our
      assumptions.  Moreover, using <span class="inlinecode"><span class="id" type="var">m_step</span></span> once more, we can
      show <span class="inlinecode"><span class="id" type="var">eval_many</span></span> <span class="inlinecode">(<span class="id" type="var">tm_if</span></span> <span class="inlinecode"><span class="id" type="var">tm_true</span></span> <span class="inlinecode"><span class="id" type="var">t1</span></span> <span class="inlinecode"><span class="id" type="var">t2</span>)</span> <span class="inlinecode"><span class="id" type="var">u</span></span> where <span class="inlinecode"><span class="id" type="var">t'</span></span> is
      chosen to be <span class="inlinecode"><span class="id" type="var">t1</span></span>.  Doing so leaves us to show
      <span class="inlinecode"><span class="id" type="tactic">eval</span></span> <span class="inlinecode">(<span class="id" type="var">tm_if</span></span> <span class="inlinecode"><span class="id" type="var">tm_true</span></span> <span class="inlinecode"><span class="id" type="var">t1</span></span> <span class="inlinecode"><span class="id" type="var">t2</span>)</span> <span class="inlinecode"><span class="id" type="var">t1</span></span> and <span class="inlinecode"><span class="id" type="var">eval_many</span></span> <span class="inlinecode"><span class="id" type="var">t1</span></span> <span class="inlinecode"><span class="id" type="var">u</span></span>.  The
      former holds by <span class="inlinecode"><span class="id" type="var">e_iftrue</span></span> and the latter holds by
      assumption. 
</div>
<div class="code">

<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab77"></a><h2 class="section">Working with Definitions</h2>


<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" type="tactic">unfold</span></span>

</li>
</ul>

<div class="paragraph"> </div>

<a name="lab78"></a><h3 class="section">Example</h3>

    There is a notion of equivalence on Coq terms that arises
    from the conversion rules of the underlying calculus of
    constructions.  It is sometimes useful to be able to replace
    one term in a proof with an equivalent one.  For instance,
    we may want to replace a defined name with its definition.
    This sort of replacement can be done the tactic <span class="inlinecode"><span class="id" type="tactic">unfold</span></span>.
    This tactic can be used to manipulate the goal or the
    hypotheses.

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">strongly_diverges</span> <span class="id" type="var">t</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">u</span>, <span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span> -&gt; ~ <span class="id" type="var">normal_form</span> <span class="id" type="var">u</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">unfold_example</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">strongly_diverges</span> <span class="id" type="var">t</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">strongly_diverges</span> <span class="id" type="var">t'</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span class="id" type="var">Hd</span> <span class="id" type="var">He</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">strongly_diverges</span>. <span class="id" type="tactic">intros</span> <span class="id" type="var">u</span> <span class="id" type="var">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">strongly_diverges</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hd</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Hd</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">m_step</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">t'</span> := <span class="id" type="var">t'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">He</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Hm</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab79"></a><h3 class="section">Exercise</h3>

    In reality, many tactics will perform conversion
    automatically as necessary.  Try removing the uses of
    <span class="inlinecode"><span class="id" type="tactic">unfold</span></span> from the above proof to check which ones were
    necessary.

<div class="paragraph"> </div>

<a name="lab80"></a><h2 class="section">Working with Conjunction and Disjunction</h2>


<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" type="tactic">split</span></span>

</li>
<li> <span class="inlinecode"><span class="id" type="tactic">left</span></span>

</li>
<li> <span class="inlinecode"><span class="id" type="tactic">right</span></span>

</li>
<li> <span class="inlinecode"><span class="id" type="tactic">destruct</span></span> (for conjunction and disjunction)

</li>
</ul>

<div class="paragraph"> </div>

<a name="lab81"></a><h3 class="section">Example</h3>

    If <span class="inlinecode"><span class="id" type="var">H</span></span> is the name of a conjunctive hypothesis, then
    <span class="inlinecode"><span class="id" type="tactic">destruct</span></span> <span class="inlinecode"><span class="id" type="var">H</span></span> <span class="inlinecode"><span class="id" type="keyword">as</span></span> <span class="inlinecode"><span class="id" type="var">p</span></span> will replace the hypothesis <span class="inlinecode"><span class="id" type="var">H</span></span> with its
    components using the names in the pattern <span class="inlinecode"><span class="id" type="var">p</span></span>.  Observe the
    pattern in the example below.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">m_two_conj</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span class="id" type="var">t''</span>,<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> /\ <span class="id" type="tactic">eval</span> <span class="id" type="var">t'</span> <span class="id" type="var">t''</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">t''</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span class="id" type="var">t''</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [ <span class="id" type="var">He1</span> <span class="id" type="var">He2</span> ].<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_two</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">t2</span> := <span class="id" type="var">t'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">He1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">He2</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab82"></a><h3 class="section">Example</h3>

    Patterns may be nested to break apart nested structures.
    Note that infix conjunction is right-associative, which is
    significant when trying to write nested patterns.  We will
    later see how to use <span class="inlinecode"><span class="id" type="tactic">destruct</span></span> on many different sorts of
    hypotheses.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">m_three_conj</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span class="id" type="var">t''</span> <span class="id" type="var">t'''</span>,<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> /\ <span class="id" type="tactic">eval</span> <span class="id" type="var">t'</span> <span class="id" type="var">t''</span> /\ <span class="id" type="tactic">eval</span> <span class="id" type="var">t''</span> <span class="id" type="var">t'''</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">t'''</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span class="id" type="var">t''</span> <span class="id" type="var">t'''</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [ <span class="id" type="var">He1</span> [ <span class="id" type="var">He2</span> <span class="id" type="var">He3</span> ] ].<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_step</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">t'</span> := <span class="id" type="var">t'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">He1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_two</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">t2</span> := <span class="id" type="var">t''</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">He2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">He3</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab83"></a><h3 class="section">Example</h3>

    If your goal is a conjunction, use <span class="inlinecode"><span class="id" type="tactic">split</span></span> to break it apart
    into two separate subgoals.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">m_three</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span class="id" type="var">t''</span> <span class="id" type="var">t'''</span>,<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t'</span> <span class="id" type="var">t''</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t''</span> <span class="id" type="var">t'''</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">t'''</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span class="id" type="var">t''</span> <span class="id" type="var">t'''</span> <span class="id" type="var">He1</span> <span class="id" type="var">He2</span> <span class="id" type="var">He3</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_three_conj</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">t'</span> := <span class="id" type="var">t'</span>) (<span class="id" type="var">t''</span> := <span class="id" type="var">t''</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">He1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">He2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">He3</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab84"></a><h3 class="section">Exercise</h3>

    Hint: You might find lemma <span class="inlinecode"><span class="id" type="var">m_three</span></span> useful here.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">m_if_iszero_conj</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">v</span> <span class="id" type="var">t2</span> <span class="id" type="var">t2'</span> <span class="id" type="var">t3</span> <span class="id" type="var">t3'</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">nvalue</span> <span class="id" type="var">v</span> /\ <span class="id" type="tactic">eval</span> <span class="id" type="var">t2</span> <span class="id" type="var">t2'</span> /\ <span class="id" type="tactic">eval</span> <span class="id" type="var">t3</span> <span class="id" type="var">t3'</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> (<span class="id" type="var">tm_if</span> (<span class="id" type="var">tm_iszero</span> <span class="id" type="var">tm_zero</span>) <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>) <span class="id" type="var">t2'</span> /\<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> (<span class="id" type="var">tm_if</span> (<span class="id" type="var">tm_iszero</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">v</span>)) <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>) <span class="id" type="var">t3'</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab85"></a><h3 class="section">Example</h3>

    If the goal is a disjunction, we can use the <span class="inlinecode"><span class="id" type="tactic">left</span></span> or
    <span class="inlinecode"><span class="id" type="tactic">right</span></span> tactics to solve it by proving the left or right
    side of the conclusion.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">true_and_succ_zero_values</span> :<br/>
&nbsp;&nbsp;<span class="id" type="var">value</span> <span class="id" type="var">tm_true</span> /\ <span class="id" type="var">value</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">tm_zero</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">value</span>. <span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">left</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">b_true</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">right</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">n_succ</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">n_zero</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab86"></a><h3 class="section">Example</h3>

    If we have a disjunction in the context, we can use
    <span class="inlinecode"><span class="id" type="tactic">destruct</span></span> to reason by cases on the hypothesis.  Note the
    syntax of the associated pattern.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">e_if_true_or_false</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t1</span> <span class="id" type="var">tm_true</span> \/ <span class="id" type="tactic">eval</span> <span class="id" type="var">t1</span> <span class="id" type="var">tm_false</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> (<span class="id" type="var">tm_if</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t2</span>) <span class="id" type="var">t2</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [ <span class="id" type="var">He1</span> | <span class="id" type="var">He2</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_two</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">t2</span> := <span class="id" type="var">tm_if</span> <span class="id" type="var">tm_true</span> <span class="id" type="var">t2</span> <span class="id" type="var">t2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">e_if</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">He1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">e_iftrue</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_two</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">t2</span> := <span class="id" type="var">tm_if</span> <span class="id" type="var">tm_false</span> <span class="id" type="var">t2</span> <span class="id" type="var">t2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">e_if</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">He2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">e_iffalse</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<a name="lab87"></a><h3 class="section">Exercise</h3>

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">two_values</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">value</span> <span class="id" type="var">t</span> /\ <span class="id" type="var">value</span> <span class="id" type="var">u</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">bvalue</span> <span class="id" type="var">t</span> \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">bvalue</span> <span class="id" type="var">u</span> \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">nvalue</span> <span class="id" type="var">t</span> /\ <span class="id" type="var">nvalue</span> <span class="id" type="var">u</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
</div>

<div class="doc">
We know <span class="inlinecode"><span class="id" type="var">value</span></span> <span class="inlinecode"><span class="id" type="var">t</span></span> and <span class="inlinecode"><span class="id" type="var">value</span></span> <span class="inlinecode"><span class="id" type="var">u</span></span>, which means either
      <span class="inlinecode"><span class="id" type="var">bvalue</span></span> <span class="inlinecode"><span class="id" type="var">t</span></span> or <span class="inlinecode"><span class="id" type="var">nvalue</span></span> <span class="inlinecode"><span class="id" type="var">t</span></span>, and either <span class="inlinecode"><span class="id" type="var">bvalue</span></span> <span class="inlinecode"><span class="id" type="var">u</span></span> or
      <span class="inlinecode"><span class="id" type="var">nvalue</span></span> <span class="inlinecode"><span class="id" type="var">u</span></span>.  Consider the case in which
      <span class="inlinecode"><span class="id" type="var">bvalue</span></span> <span class="inlinecode"><span class="id" type="var">t</span></span> holds. Then one of the disjuncts of our
      conclusion is proved.  Next, consider the case in which
      <span class="inlinecode"><span class="id" type="var">nvalue</span></span> <span class="inlinecode"><span class="id" type="var">t</span></span> holds.  Now consider the subcase where
      <span class="inlinecode"><span class="id" type="var">bvalue</span></span> <span class="inlinecode"><span class="id" type="var">u</span></span> holds. ... 
</div>
<div class="code">

<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab88"></a><h3 class="section">Example</h3>

    <span class="inlinecode"><span class="id" type="tactic">destruct</span></span> can be used on propositions with implications.
    This will have the effect of performing <span class="inlinecode"><span class="id" type="tactic">destruct</span></span> on the
    conclusion of the implication, while leaving the hypotheses
    of the implication as additional subgoals.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">destruct_example</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">bv</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span class="id" type="var">t''</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">bvalue</span> <span class="id" type="var">bv</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id" type="var">value</span> <span class="id" type="var">bv</span> -&gt; <span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> /\ <span class="id" type="tactic">eval</span> <span class="id" type="var">t'</span> <span class="id" type="var">t''</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">t''</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">bv</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span class="id" type="var">t''</span> <span class="id" type="var">Hbv</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [ <span class="id" type="var">H1</span> <span class="id" type="var">H2</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Show</span> 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">value</span>. <span class="id" type="tactic">left</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">Hbv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_two</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">t2</span> := <span class="id" type="var">t'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">H2</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab89"></a><h3 class="section">Tip</h3>

    After applying a tactic that introduces multiple subgoals,
    it is sometimes useful to see not only the subgoals
    themselves but also their hypotheses.  Adding the command
    <span class="inlinecode"><span class="id" type="keyword">Show</span></span> <span class="inlinecode"><span class="id" type="var">n</span>.</span> to your proof script to cause Coq to display the
    nth subgoal in full.

<div class="paragraph"> </div>

<a name="lab90"></a><h2 class="section">Reasoning by Cases and Induction</h2>


<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" type="tactic">destruct</span></span> (for inductively defined propositions)

</li>
<li> <span class="inlinecode"><span class="id" type="tactic">induction</span></span>

</li>
</ul>

<div class="paragraph"> </div>

<a name="lab91"></a><h3 class="section">Example</h3>

    Use <span class="inlinecode"><span class="id" type="tactic">destruct</span></span> to reason by cases on an inductively defined
    datatype or proposition.

<div class="paragraph"> </div>

    Note: It is possible to supply <span class="inlinecode"><span class="id" type="tactic">destruct</span></span> with a pattern in
    these instances also.  However, the patterns become
    increasingly complex for bigger inductive definitions; so it
    is often more practical to omit the pattern (thereby letting
    Coq choose the names of the terms and hypotheses in each
    case), in spite of the fact that this adds an element of
    fragility to the proof script (since the proof script will
    mention names that were system-generated).

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">e_iszero_nvalue</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">nvalue</span> <span class="id" type="var">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> (<span class="id" type="var">tm_iszero</span> <span class="id" type="var">v</span>) <span class="id" type="var">tm_true</span> \/<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> (<span class="id" type="var">tm_iszero</span> <span class="id" type="var">v</span>) <span class="id" type="var">tm_false</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">v</span> <span class="id" type="var">Hn</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">Hn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">left</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">e_iszerozero</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">right</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">e_iszerosucc</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">Hn</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab92"></a><h3 class="section">Example</h3>

    You can use <span class="inlinecode"><span class="id" type="tactic">induction</span></span> to reason by induction on an
    inductively defined datatype or proposition.  This is the
    same as <span class="inlinecode"><span class="id" type="tactic">destruct</span></span>, except that it also introduces an
    induction hypothesis in the inductive cases.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">m_iszero</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> (<span class="id" type="var">tm_iszero</span> <span class="id" type="var">t</span>) (<span class="id" type="var">tm_iszero</span> <span class="id" type="var">u</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span> <span class="id" type="var">Hm</span>. <span class="id" type="tactic">induction</span> <span class="id" type="var">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_refl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_step</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">t'</span> := <span class="id" type="var">tm_iszero</span> <span class="id" type="var">t'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">e_iszero</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHHm</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<a name="lab93"></a><h3 class="section">Exercise</h3>

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">m_trans</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span class="id" type="var">u</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t'</span> <span class="id" type="var">u</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
</div>

<div class="doc">
We proceed by induction on the derivation of
      <span class="inlinecode"><span class="id" type="var">eval_many</span></span> <span class="inlinecode"><span class="id" type="var">t</span></span> <span class="inlinecode"><span class="id" type="var">t'</span></span>.
      Case <span class="inlinecode"><span class="id" type="var">m_refl</span></span>: Since <span class="inlinecode"><span class="id" type="var">t</span></span> and <span class="inlinecode"><span class="id" type="var">t'</span></span> must be the same, our
        conclusion holds by assumption.
      Case <span class="inlinecode"><span class="id" type="var">m_step</span></span>: Now let's rename the <span class="inlinecode"><span class="id" type="var">t'</span></span> from the lemma
        statement to <span class="inlinecode"><span class="id" type="var">u0</span></span> (as Coq likely will) and observe that
        there must be some <span class="inlinecode"><span class="id" type="var">t'</span></span> (from above the line of the
        <span class="inlinecode"><span class="id" type="var">m_step</span></span> rule) such that <span class="inlinecode"><span class="id" type="tactic">eval</span></span> <span class="inlinecode"><span class="id" type="var">t</span></span> <span class="inlinecode"><span class="id" type="var">t'</span></span> and
        <span class="inlinecode"><span class="id" type="var">eval_many</span></span> <span class="inlinecode"><span class="id" type="var">t'</span></span> <span class="inlinecode"><span class="id" type="var">u0</span></span>.  Our conclusion follows from from
        an application of <span class="inlinecode"><span class="id" type="var">m_step</span></span> with our new <span class="inlinecode"><span class="id" type="var">t'</span></span> and our
        induction hypothesis, which allows us to piece together
        <span class="inlinecode"><span class="id" type="var">eval_many</span></span> <span class="inlinecode"><span class="id" type="var">t'</span></span> <span class="inlinecode"><span class="id" type="var">u0</span></span> and <span class="inlinecode"><span class="id" type="var">eval_many</span></span> <span class="inlinecode"><span class="id" type="var">u0</span></span> <span class="inlinecode"><span class="id" type="var">u</span></span> to get
        <span class="inlinecode"><span class="id" type="var">eval_many</span></span> <span class="inlinecode"><span class="id" type="var">t'</span></span> <span class="inlinecode"><span class="id" type="var">u</span></span>. 
</div>
<div class="code">

<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab94"></a><h3 class="section">Exercise</h3>

    It is possible to use <span class="inlinecode"><span class="id" type="tactic">destruct</span></span> not just on hypotheses but
    on any lemma we have proved.  If we have a lemma
<pre>
      lemma1 : P /\ Q
</pre>
    then we can use the tactic
<pre>
      destruct lemma1 as [ H1 H2 ].
</pre>
    to continue our proof with <span class="inlinecode"><span class="id" type="var">H1</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" type="var">P</span></span> and <span class="inlinecode"><span class="id" type="var">H2</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" type="var">Q</span></span> in our
    context.  This works even if the lemma has antecedents (they
    become new subgoals); however it fail if the lemma has a
    universal quantifier, such as this:
<pre>
      lemma2 : forall x, P(x) /\ Q(x)
</pre>
    However, remember that we can build a proof of
    <span class="inlinecode"><span class="id" type="var">P</span>(<span class="id" type="var">e</span>)</span> <span class="inlinecode">/\</span> <span class="inlinecode"><span class="id" type="var">Q</span>(<span class="id" type="var">e</span>)</span> (which can be destructed) using the Coq
    expression <span class="inlinecode"><span class="id" type="var">lemma2</span></span> <span class="inlinecode"><span class="id" type="var">e</span></span>.  So we need to phrase our tactic as
<pre>
      destruct (lemma2 e) as [ H1 H2 ].
</pre>
    An example of this technique is below.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">m_iszero_nvalue</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">nvalue</span> <span class="id" type="var">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> (<span class="id" type="var">tm_iszero</span> <span class="id" type="var">t</span>) <span class="id" type="var">tm_true</span> \/<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> (<span class="id" type="var">tm_iszero</span> <span class="id" type="var">t</span>) <span class="id" type="var">tm_false</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">v</span> <span class="id" type="var">Hnv</span> <span class="id" type="var">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<span class="id" type="var">e_iszero_nvalue</span> <span class="id" type="var">v</span>) <span class="id" type="keyword">as</span> [ <span class="id" type="var">H1</span> | <span class="id" type="var">H2</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Hnv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">left</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">m_trans</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">t'</span> := <span class="id" type="var">tm_iszero</span> <span class="id" type="var">v</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_iszero</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_one</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">right</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">m_trans</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">t'</span> := <span class="id" type="var">tm_iszero</span> <span class="id" type="var">v</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_iszero</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_one</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H2</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab95"></a><h3 class="section">Exercise</h3>

    Prove the following lemma.

<div class="paragraph"> </div>

    Hint: You may be interested in some previously proved
    lemmas, such as <span class="inlinecode"><span class="id" type="var">m_one</span></span> and <span class="inlinecode"><span class="id" type="var">m_trans</span></span>.

<div class="paragraph"> </div>

    Note: Even though this lemma is in a comment, its solution
    is also at the bottom.  (Coq will give an error if we leave
    it uncommented since it mentions the <span class="inlinecode"><span class="id" type="var">eval_rtc</span></span> relation,
    which was the solution to another exercise.)
<pre>
Lemma eval_rtc_many : forall t u,
  eval_rtc t u -&gt;
  eval_many t u.
</pre>

<div class="paragraph"> </div>

<a name="lab96"></a><h3 class="section">Exercise</h3>

    Prove the following lemma.
<pre>
Lemma eval_many_rtc : forall t u,
  eval_many t u -&gt;
  eval_rtc t u.
</pre>

<div class="paragraph"> </div>

<a name="lab97"></a><h3 class="section">Exercise</h3>

    Prove the following lemma.
<pre>
Lemma full_eval_to_value : forall t v,
  full_eval t v -&gt;
  value v.
</pre>

<div class="paragraph"> </div>

<a name="lab98"></a><h2 class="section">Working with Existential Quantification</h2>


<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" type="tactic">exists</span></span>

</li>
<li> <span class="inlinecode"><span class="id" type="tactic">destruct</span></span> (for existential propositions)

</li>
</ul>

<div class="paragraph"> </div>

<a name="lab99"></a><h3 class="section">Example</h3>

    Use <span class="inlinecode"><span class="id" type="tactic">exists</span></span> to give the witness for an existential
    quantifier in your goal.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">if_bvalue</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">bvalue</span> <span class="id" type="var">t1</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exists</span> <span class="id" type="var">u</span>, <span class="id" type="tactic">eval</span> (<span class="id" type="var">tm_if</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>) <span class="id" type="var">u</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span> <span class="id" type="var">Hb</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">Hb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">exists</span> <span class="id" type="var">t2</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">e_iftrue</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">exists</span> <span class="id" type="var">t3</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">e_iffalse</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab100"></a><h3 class="section">Example</h3>

    You may use <span class="inlinecode"><span class="id" type="tactic">destruct</span></span> to break open an existential
    hypothesis.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">m_two_exists</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span>,<br/>
&nbsp;&nbsp;(<span class="id" type="tactic">exists</span> <span class="id" type="var">w</span>, <span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">w</span> /\ <span class="id" type="tactic">eval</span> <span class="id" type="var">w</span> <span class="id" type="var">u</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [ <span class="id" type="var">w</span> <span class="id" type="var">He</span> ].<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">He</span> <span class="id" type="keyword">as</span> [ <span class="id" type="var">He1</span> <span class="id" type="var">He2</span> ].<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_two</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">t2</span> := <span class="id" type="var">w</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">He1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">He2</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab101"></a><h3 class="section">Example</h3>

    Tip: We can combine patterns that destruct existentials with
    patterns that destruct other logical connectives.

<div class="paragraph"> </div>

    Here is the same proof with just one use of <span class="inlinecode"><span class="id" type="tactic">destruct</span></span>.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">m_two_exists'</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span>,<br/>
&nbsp;&nbsp;(<span class="id" type="tactic">exists</span> <span class="id" type="var">w</span>, <span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">w</span> /\ <span class="id" type="tactic">eval</span> <span class="id" type="var">w</span> <span class="id" type="var">u</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [ <span class="id" type="var">w</span> [ <span class="id" type="var">He1</span> <span class="id" type="var">He2</span> ] ].<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_two</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">t2</span> := <span class="id" type="var">w</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">He1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">He2</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab102"></a><h3 class="section">Example</h3>

    Tip: We give patterns to the <span class="inlinecode"><span class="id" type="tactic">intros</span></span> tactic to destruct
    hypotheses as we introduce them.

<div class="paragraph"> </div>

    Here is the same proof again without any uses of <span class="inlinecode"><span class="id" type="tactic">destruct</span></span>.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">m_two_exists''</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span>,<br/>
&nbsp;&nbsp;(<span class="id" type="tactic">exists</span> <span class="id" type="var">w</span>, <span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">w</span> /\ <span class="id" type="tactic">eval</span> <span class="id" type="var">w</span> <span class="id" type="var">u</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span> [ <span class="id" type="var">w</span> [ <span class="id" type="var">He1</span> <span class="id" type="var">He2</span> ] ].<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_two</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">t2</span> := <span class="id" type="var">w</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">He1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">He2</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab103"></a><h3 class="section">Exercise</h3>

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">value_can_expand</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">value</span> <span class="id" type="var">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exists</span> <span class="id" type="var">u</span>, <span class="id" type="tactic">eval</span> <span class="id" type="var">u</span> <span class="id" type="var">v</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<a name="lab104"></a><h3 class="section">Exercise</h3>

    Tip: You should find the lemma <span class="inlinecode"><span class="id" type="var">m_iszero</span></span> useful.  Use
    <span class="inlinecode"><span class="id" type="keyword">Check</span></span> <span class="inlinecode"><span class="id" type="var">m_iszero</span>.</span> if you've forgotten its statement.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">exists_iszero_nvalue</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;(<span class="id" type="tactic">exists</span> <span class="id" type="var">nv</span>, <span class="id" type="var">nvalue</span> <span class="id" type="var">nv</span> /\ <span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">nv</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exists</span> <span class="id" type="var">bv</span>, <span class="id" type="var">eval_many</span> (<span class="id" type="var">tm_iszero</span> <span class="id" type="var">t</span>) <span class="id" type="var">bv</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
</div>

<div class="doc">
There exists some <span class="inlinecode"><span class="id" type="var">nv</span></span> such that <span class="inlinecode"><span class="id" type="var">nvalue</span></span> <span class="inlinecode"><span class="id" type="var">nv</span></span>.  Consider
      the case where <span class="inlinecode"><span class="id" type="var">nv</span></span> is <span class="inlinecode"><span class="id" type="var">tm_zero</span></span>.  Then choose <span class="inlinecode"><span class="id" type="var">bv</span></span> to
      be <span class="inlinecode"><span class="id" type="var">tm_true</span></span>.  By <span class="inlinecode"><span class="id" type="var">m_trans</span></span>, we can show that
      <span class="inlinecode"><span class="id" type="var">eval_many</span></span> <span class="inlinecode">(<span class="id" type="var">tm_iszero</span></span> <span class="inlinecode"><span class="id" type="var">t</span>)</span> <span class="inlinecode"><span class="id" type="var">tm_true</span></span> by showing
      <span class="inlinecode"><span class="id" type="var">eval_many</span></span> <span class="inlinecode">(<span class="id" type="var">tm_iszero</span></span> <span class="inlinecode"><span class="id" type="var">t</span>)</span> <span class="inlinecode">(<span class="id" type="var">tm_iszero</span></span> <span class="inlinecode"><span class="id" type="var">tm_zero</span>)</span> and
      <span class="inlinecode"><span class="id" type="var">eval_many</span></span> <span class="inlinecode">(<span class="id" type="var">tm_iszero</span></span> <span class="inlinecode"><span class="id" type="var">tm_zero</span>)</span> <span class="inlinecode"><span class="id" type="var">tm_true</span></span>.  The former
      follows from <span class="inlinecode"><span class="id" type="var">m_iszero</span></span> and our assumption.  The latter
      follows from <span class="inlinecode"><span class="id" type="var">m_one</span></span> and the rule <span class="inlinecode"><span class="id" type="var">e_iszerozero</span></span>.  On the
      other hand, in the case where <span class="inlinecode"><span class="id" type="var">nv</span></span> is built from
      <span class="inlinecode"><span class="id" type="var">tm_succ</span></span>, we choose <span class="inlinecode"><span class="id" type="var">bv</span></span> to be <span class="inlinecode"><span class="id" type="var">tm_false</span></span> and the proof
      follows similarly. 
</div>
<div class="code">

<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab105"></a><h2 class="section">Working with Negation</h2>


<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" type="tactic">unfold</span></span> <span class="inlinecode"><span class="id" type="var">not</span></span>

</li>
<li> <span class="inlinecode"><span class="id" type="tactic">destruct</span></span> (for negation)

</li>
</ul>

<div class="paragraph"> </div>

<a name="lab106"></a><h3 class="section">Example</h3>

    The standard library defines an uninhabited type <span class="inlinecode"><span class="id" type="var">False</span></span> and
    defines <span class="inlinecode"><span class="id" type="var">not</span></span> <span class="inlinecode"><span class="id" type="var">P</span></span> to stand for <span class="inlinecode"><span class="id" type="var">P</span></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><span class="id" type="var">False</span></span>.  Furthermore, Coq
    defines the notation <span class="inlinecode">~</span> <span class="inlinecode"><span class="id" type="var">P</span></span> to stand for <span class="inlinecode"><span class="id" type="var">not</span></span> <span class="inlinecode"><span class="id" type="var">P</span></span>.  (Such
    notations only affect parsing and printing -- Coq views <span class="inlinecode"><span class="id" type="var">not</span></span>
    <span class="inlinecode"><span class="id" type="var">P</span></span> and <span class="inlinecode">~</span> <span class="inlinecode"><span class="id" type="var">P</span></span> as being syntactically equal.)

<div class="paragraph"> </div>

    The most basic way to work with negated statements is to
    unfold <span class="inlinecode"><span class="id" type="var">not</span></span> and treat <span class="inlinecode"><span class="id" type="var">False</span></span> just as any other
    proposition.

<div class="paragraph"> </div>

    (Note how multiple definitions can be unfolded with one use
    of <span class="inlinecode"><span class="id" type="tactic">unfold</span></span>.  Also, as noted earlier, many uses of <span class="inlinecode"><span class="id" type="tactic">unfold</span></span>
    are not strictly necessary.  You can try deleting the uses
    from the proof below to check that the proof script still
    works.)

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">normal_form_succ</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">normal_form</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">normal_form</span> <span class="id" type="var">t</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">Hnf</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">normal_form</span>. <span class="id" type="tactic">unfold</span> <span class="id" type="var">not</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">normal_form</span>, <span class="id" type="var">not</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hnf</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> [ <span class="id" type="var">t'</span> <span class="id" type="var">H'</span> ]. <span class="id" type="tactic">apply</span> <span class="id" type="var">Hnf</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">exists</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t'</span>). <span class="id" type="tactic">apply</span> <span class="id" type="var">e_succ</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H'</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab107"></a><h3 class="section">Exercise</h3>

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">normal_form_to_forall</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">normal_form</span> <span class="id" type="var">t</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">u</span>, ~ <span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab108"></a><h3 class="section">Exercise</h3>

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">normal_form_from_forall</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> <span class="id" type="var">u</span>, ~ <span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">normal_form</span> <span class="id" type="var">t</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab109"></a><h3 class="section">Example</h3>

    If you happen to have <span class="inlinecode"><span class="id" type="var">False</span></span> as a hypothesis, you may use
    <span class="inlinecode"><span class="id" type="tactic">destruct</span></span> on that hypothesis to solve your goal.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">False_hypothesis</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">False</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">value</span> <span class="id" type="var">v</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">v</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab110"></a><h3 class="section">Example</h3>

    Recalling that <span class="inlinecode"><span class="id" type="tactic">destruct</span></span> can be used on propositions with
    antecedents and that negation is simply an abbreviation for
    an implication, using <span class="inlinecode"><span class="id" type="tactic">destruct</span></span> on a negated hypothesis has
    the derived behavior of replacing our goal with the
    proposition that was negated in our context.

<div class="paragraph"> </div>

    Tip: We actually don't even need to do the unfolding below
    because <span class="inlinecode"><span class="id" type="tactic">destruct</span></span> would have done it for us.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">destruct_negation_example</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">value</span> <span class="id" type="var">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">tm_zero</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id" type="var">value</span> <span class="id" type="var">v</span> -&gt; <span class="id" type="var">normal_form</span> <span class="id" type="var">t</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">tm_true</span> <span class="id" type="var">tm_false</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">v</span> <span class="id" type="var">Hnv</span> <span class="id" type="var">He</span> <span class="id" type="var">Hnf</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">normal_form</span>, <span class="id" type="var">not</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hnf</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">Hnf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Hnv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">exists</span> <span class="id" type="var">tm_zero</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">He</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab111"></a><h3 class="section">Exercise</h3>

    This one may be a bit tricky.  Start by using <span class="inlinecode"><span class="id" type="tactic">destruct</span></span> on
    one of your hypotheses.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">negation_exercise</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">v1</span> <span class="id" type="var">v2</span>,<br/>
&nbsp;&nbsp;~ (<span class="id" type="var">value</span> <span class="id" type="var">v1</span> \/ <span class="id" type="var">value</span> <span class="id" type="var">v2</span>) -&gt;<br/>
&nbsp;&nbsp;~ (~ <span class="id" type="var">bvalue</span> <span class="id" type="var">v1</span> /\ ~ <span class="id" type="var">bvalue</span> <span class="id" type="var">v2</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">tm_true</span> <span class="id" type="var">tm_false</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab112"></a><h2 class="section">Working with Equality</h2>


<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" type="tactic">reflexivity</span></span>

</li>
<li> <span class="inlinecode"><span class="id" type="tactic">subst</span></span>

</li>
<li> <span class="inlinecode"><span class="id" type="tactic">rewrite</span></span>

</li>
<li> <span class="inlinecode"><span class="id" type="tactic">inversion</span></span> (on equalities)

</li>
</ul>

<div class="paragraph"> </div>

<a name="lab113"></a><h3 class="section">Example</h3>

    If you have an equality in your context, there are several
    ways to substitute one side of the equality for the other in
    your goal or in other hypotheses.

<div class="paragraph"> </div>

    If one side of the equality is a variable <span class="inlinecode"><span class="id" type="var">x</span></span>, then the
    tactic <span class="inlinecode"><span class="id" type="tactic">subst</span></span> <span class="inlinecode"><span class="id" type="var">x</span></span> will replace all occurrences of <span class="inlinecode"><span class="id" type="var">x</span></span> in the
    context and goal with the other side of the quality and will
    remove <span class="inlinecode"><span class="id" type="var">x</span></span> from your context.

<div class="paragraph"> </div>

    Use <span class="inlinecode"><span class="id" type="tactic">reflexivity</span></span> to solve a goal of the form <span class="inlinecode"><span class="id" type="var">e</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" type="var">e</span></span>.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">equality_example_1</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span> <span class="id" type="var">u1</span> <span class="id" type="var">u2</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">t1</span> = <span class="id" type="var">tm_iszero</span> <span class="id" type="var">u1</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">t2</span> = <span class="id" type="var">tm_succ</span> <span class="id" type="var">u2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">t3</span> = <span class="id" type="var">tm_succ</span> <span class="id" type="var">t2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">tm_if</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">tm_if</span> (<span class="id" type="var">tm_iszero</span> <span class="id" type="var">u1</span>) (<span class="id" type="var">tm_succ</span> <span class="id" type="var">u2</span>) (<span class="id" type="var">tm_succ</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">u2</span>)).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span> <span class="id" type="var">u1</span> <span class="id" type="var">u2</span> <span class="id" type="var">Heq1</span> <span class="id" type="var">Heq2</span> <span class="id" type="var">Heq3</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span> <span class="id" type="var">t1</span>. <span class="id" type="tactic">subst</span> <span class="id" type="var">t2</span>. <span class="id" type="tactic">subst</span> <span class="id" type="var">t3</span>. <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab114"></a><h3 class="section">Example</h3>

    If neither side of the equality in your context is a
    variable (or if you don't want to discard the hypothesis),
    you can use the <span class="inlinecode"><span class="id" type="tactic">rewrite</span></span> tactic to perform a substitution.
    The arrow after <span class="inlinecode"><span class="id" type="tactic">rewrite</span></span> indicates the direction of the
    substitution.  As demonstrated, you may perform rewriting in
    the goal or in a hypothesis.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">equality_example_2a</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span> = <span class="id" type="var">tm_succ</span> <span class="id" type="var">u</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">u</span>) <span class="id" type="var">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span>) <span class="id" type="var">v</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span> <span class="id" type="var">v</span> <span class="id" type="var">Heq</span> <span class="id" type="var">He</span>. <span class="id" type="tactic">rewrite</span> -&gt; <span class="id" type="var">Heq</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">He</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">equality_example_2b</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span> = <span class="id" type="var">tm_succ</span> <span class="id" type="var">u</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">u</span>) <span class="id" type="var">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span>) <span class="id" type="var">v</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span> <span class="id" type="var">v</span> <span class="id" type="var">Heq</span> <span class="id" type="var">He</span>. <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">Heq</span> <span class="id" type="keyword">in</span> <span class="id" type="var">He</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">He</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab115"></a><h3 class="section">Example</h3>

    We also note that, analogously with <span class="inlinecode"><span class="id" type="tactic">destruct</span></span>, we may use
    <span class="inlinecode"><span class="id" type="tactic">rewrite</span></span> even with a hypothesis (or lemma) that has
    antecedents.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">equality_example_2c</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">nvalue</span> <span class="id" type="var">v</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id" type="var">nvalue</span> <span class="id" type="var">v</span> -&gt; <span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span> = <span class="id" type="var">tm_succ</span> <span class="id" type="var">u</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">u</span>) <span class="id" type="var">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span>) <span class="id" type="var">v</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span> <span class="id" type="var">v</span> <span class="id" type="var">Hnv</span> <span class="id" type="var">Heq</span> <span class="id" type="var">He</span>. <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">Heq</span> <span class="id" type="keyword">in</span> <span class="id" type="var">He</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">He</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Hnv</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab116"></a><h3 class="section">Example</h3>

    If you need to derive additional equalities implied by an
    equality in your context (e.g., by the principle of
    constructor injectivity), you may use <span class="inlinecode"><span class="id" type="tactic">inversion</span></span>.
    <span class="inlinecode"><span class="id" type="tactic">inversion</span></span> is a powerful tactic that uses unification to
    introduce more equalities into your context.  (You will
    observe that it also performs some substitutions in your
    goal.)

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">equality_example_3</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span> = <span class="id" type="var">tm_succ</span> <span class="id" type="var">u</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">t</span> = <span class="id" type="var">u</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab117"></a><h3 class="section">Exercise</h3>

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">equality_exercise</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span> <span class="id" type="var">u1</span> <span class="id" type="var">u2</span> <span class="id" type="var">u3</span> <span class="id" type="var">u4</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">tm_if</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span> = <span class="id" type="var">tm_if</span> <span class="id" type="var">u1</span> <span class="id" type="var">u2</span> <span class="id" type="var">u2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">tm_if</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span> = <span class="id" type="var">tm_if</span> <span class="id" type="var">u3</span> <span class="id" type="var">u3</span> <span class="id" type="var">u4</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">t1</span> = <span class="id" type="var">u4</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab118"></a><h3 class="section">Example</h3>

    <span class="inlinecode"><span class="id" type="tactic">inversion</span></span> will also solve a goal when unification fails on
    a hypothesis.  (Internally, Coq can construct a proof of
    <span class="inlinecode"><span class="id" type="var">False</span></span> from contradictory equalities.)

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">equality_example_4</span> :<br/>
&nbsp;&nbsp;<span class="id" type="var">tm_zero</span> = <span class="id" type="var">tm_true</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">tm_true</span> <span class="id" type="var">tm_false</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<a name="lab119"></a><h3 class="section">Exercise</h3>

    Note: <span class="inlinecode"><span class="id" type="var">e1</span></span> <span class="inlinecode">&lt;&gt;</span> <span class="inlinecode"><span class="id" type="var">e2</span></span> is a notation for <span class="inlinecode">~</span> <span class="inlinecode"><span class="id" type="var">e1</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" type="var">e2</span></span>, i.e., the
    two are treated as syntactically equal.

<div class="paragraph"> </div>

    Note: This is fairly trivial to prove if we have a size
    function on terms and some automation.  With just the tools
    we have described so far, it requires just a little bit of
    work.

<div class="paragraph"> </div>

    Hint: The proof requires induction on <span class="inlinecode"><span class="id" type="var">t</span></span>.  (This is the
    first example of induction on datatypes, but it is even more
    straightforward than induction on propositions.)  In each
    case, unfold the negation, pull the equality into the
    context, and use <span class="inlinecode"><span class="id" type="tactic">inversion</span></span> to eliminate contradictory
    equalities.

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">succ_not_circular</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">t</span> &lt;&gt; <span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab120"></a><h2 class="section">Reasoning by Inversion</h2>


<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" type="tactic">inversion</span></span> (on propositions)

</li>
</ul>

<div class="paragraph"> </div>

<a name="lab121"></a><h3 class="section">Example</h3>

    The <span class="inlinecode"><span class="id" type="tactic">inversion</span></span> tactic also allows you to reason by
    inversion on an inductively defined proposition as in paper
    proofs: we try to match some proposition with the conclusion
    of each inference rule and only consider the cases (possibly
    none) where there is a successful unification.  In those
    cases, we may use the premises of the inference rule in our
    reasoning.

<div class="paragraph"> </div>

    Since <span class="inlinecode"><span class="id" type="tactic">inversion</span></span> may generate many equalities between
    variables, it is useful to know that using <span class="inlinecode"><span class="id" type="tactic">subst</span></span> without
    an argument will perform all possible substitutions for
    variables.  It is a little difficult to predict which
    variables will be eliminated and which will be kept by this
    tactic, but this is a typical sort of trade-off when using
    powerful tactics.

<div class="paragraph"> </div>

    (The use of <span class="inlinecode"><span class="id" type="tactic">subst</span></span> in this proof is superfluous, but you
    can observe that it simplifies the context.)

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">value_succ_nvalue</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">value</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">nvalue</span> <span class="id" type="var">t</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">unfold</span> <span class="id" type="var">value</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [ <span class="id" type="var">H1</span> | <span class="id" type="var">H2</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H2</span>. <span class="id" type="tactic">subst</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H0</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<a name="lab122"></a><h3 class="section">Exercise</h3>

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">inversion_exercise</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">normal_form</span> <span class="id" type="var">t</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> (<span class="id" type="var">tm_pred</span> <span class="id" type="var">t</span>) <span class="id" type="var">tm_zero</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">nvalue</span> <span class="id" type="var">t</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
</div>

<div class="doc">
By inversion on the <span class="inlinecode"><span class="id" type="var">eval_many</span></span> relation, then conclusion
      <span class="inlinecode"><span class="id" type="var">eval_many</span></span> <span class="inlinecode">(<span class="id" type="var">tm_pred</span></span> <span class="inlinecode"><span class="id" type="var">t</span>)</span> <span class="inlinecode"><span class="id" type="var">tm_zero</span></span> must have been derived by
      the rule <span class="inlinecode"><span class="id" type="var">m_step</span></span>, which means there is some <span class="inlinecode"><span class="id" type="var">t'</span></span> for
      which <span class="inlinecode"><span class="id" type="tactic">eval</span></span> <span class="inlinecode">(<span class="id" type="var">tm_pred</span></span> <span class="inlinecode"><span class="id" type="var">t</span>)</span> <span class="inlinecode"><span class="id" type="var">t'</span></span> and <span class="inlinecode"><span class="id" type="var">eval_many</span></span> <span class="inlinecode"><span class="id" type="var">t'</span></span> <span class="inlinecode"><span class="id" type="var">tm_zero</span></span>.
      Now, by inversion on the <span class="inlinecode"><span class="id" type="tactic">eval</span></span> relation, there are only
      three ways that <span class="inlinecode"><span class="id" type="tactic">eval</span></span> <span class="inlinecode">(<span class="id" type="var">tm_pred</span></span> <span class="inlinecode"><span class="id" type="var">t</span>)</span> <span class="inlinecode"><span class="id" type="var">t'</span></span> could have been
      derived:
<a name="lab123"></a><h1 class="section">By <span class="inlinecode"><span class="id" type="var">e_predzero</span></span>, with <span class="inlinecode"><span class="id" type="var">t</span></span> and <span class="inlinecode"><span class="id" type="var">t'</span></span> both being equal to</h1>

        <span class="inlinecode"><span class="id" type="var">tm_zero</span></span>.  Our conclusion follows from <span class="inlinecode"><span class="id" type="var">n_zero</span></span>.
<a name="lab124"></a><h1 class="section">By <span class="inlinecode"><span class="id" type="var">e_predsucc</span></span>, with <span class="inlinecode"><span class="id" type="var">t</span></span> being <span class="inlinecode"><span class="id" type="var">tm_succ</span></span> <span class="inlinecode"><span class="id" type="var">t0</span></span> where we</h1>

        have <span class="inlinecode"><span class="id" type="var">nvalue</span></span> <span class="inlinecode"><span class="id" type="var">t0</span></span>.  In this case, our conclusion is
        provable with <span class="inlinecode"><span class="id" type="var">n_succ</span></span>.
<a name="lab125"></a><h1 class="section">By <span class="inlinecode"><span class="id" type="var">e_pred</span></span>, with <span class="inlinecode"><span class="id" type="var">t</span></span> taking an evaluation step.  This</h1>

        contradicts our assumption that <span class="inlinecode"><span class="id" type="var">t</span></span> is a normal form
        (which can be shown by using <span class="inlinecode"><span class="id" type="tactic">destruct</span></span> on that
        assumption). 
</div>
<div class="code">

<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab126"></a><h3 class="section">Exercise</h3>

    Tip: Nested patterns will be useful here.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">contradictory_equalities_exercise</span> :<br/>
&nbsp;&nbsp;(<span class="id" type="tactic">exists</span> <span class="id" type="var">t</span>, <span class="id" type="tactic">exists</span> <span class="id" type="var">u</span>, <span class="id" type="tactic">exists</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">value</span> <span class="id" type="var">t</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t</span> = <span class="id" type="var">tm_succ</span> <span class="id" type="var">u</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">u</span> = <span class="id" type="var">tm_pred</span> <span class="id" type="var">v</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">tm_true</span> <span class="id" type="var">tm_false</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab127"></a><h3 class="section">Exercise</h3>

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">eval_fact_exercise</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> (<span class="id" type="var">tm_iszero</span> (<span class="id" type="var">tm_pred</span> <span class="id" type="var">t1</span>)) <span class="id" type="var">t2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t2</span> <span class="id" type="var">tm_false</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exists</span> <span class="id" type="var">u</span>, <span class="id" type="var">t1</span> = <span class="id" type="var">tm_succ</span> <span class="id" type="var">u</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab128"></a><h3 class="section">Exercise</h3>

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">normal_form_if</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">normal_form</span> (<span class="id" type="var">tm_if</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">t1</span> &lt;&gt; <span class="id" type="var">tm_true</span> /\ <span class="id" type="var">t1</span> &lt;&gt; <span class="id" type="var">tm_false</span> /\ <span class="id" type="var">normal_form</span> <span class="id" type="var">t1</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab129"></a><h2 class="section">Additional Important Tactics</h2>


<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" type="tactic">generalize</span></span> <span class="inlinecode"><span class="id" type="tactic">dependent</span></span>

</li>
<li> <span class="inlinecode"><span class="id" type="tactic">assert</span></span>

</li>
<li> <span class="inlinecode">;</span>

</li>
<li> <span class="inlinecode"><span class="id" type="tactic">clear</span></span>

</li>
</ul>

<div class="paragraph"> </div>

<a name="lab130"></a><h3 class="section">Example</h3>

    Sometimes we need to have a tactic that moves hypotheses
    from our context back into our goal.  Often this is
    because we want to perform induction in the middle of a
    proof and will not get a sufficiently general induction
    hypothesis without a goal of the correct form.  (To be
    specific, if we need to have an induction hypothesis with a
    <span class="inlinecode"><span class="id" type="keyword">forall</span></span> quantifier in front, then we must make sure our
    goal has a <span class="inlinecode"><span class="id" type="keyword">forall</span></span> quantifier in front at the time we
    invoke the <span class="inlinecode"><span class="id" type="tactic">induction</span></span> tactic.) Observe how <span class="inlinecode"><span class="id" type="tactic">generalize</span></span>
    <span class="inlinecode"><span class="id" type="tactic">dependent</span></span> achieves this in the proof below, moving the
    variable <span class="inlinecode"><span class="id" type="var">t</span></span> and all dependent hypotheses back into the
    goal.  You may want to remove the use of <span class="inlinecode"><span class="id" type="tactic">generalize</span></span>
    <span class="inlinecode"><span class="id" type="tactic">dependent</span></span> to convince yourself that it is performing an
    essential role here.

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">value_is_normal_form</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">value</span> <span class="id" type="var">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">normal_form</span> <span class="id" type="var">v</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">v</span> [ <span class="id" type="var">Hb</span> | <span class="id" type="var">Hn</span> ] [ <span class="id" type="var">t</span> <span class="id" type="var">He</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">Hb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">He</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">He</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">generalize</span> <span class="id" type="tactic">dependent</span> <span class="id" type="var">t</span>. <span class="id" type="tactic">induction</span> <span class="id" type="var">Hn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">He</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">He</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">u</span> <span class="id" type="var">He</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">He</span>. <span class="id" type="tactic">subst</span>. <span class="id" type="tactic">destruct</span> (<span class="id" type="var">IHHn</span> <span class="id" type="var">t'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">H0</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab131"></a><h3 class="section">Exercise</h3>

    Coq has many operations (called "tacticals") to combine
    smaller tactics into larger ones.

<div class="paragraph"> </div>

    If <span class="inlinecode"><span class="id" type="var">t1</span></span> and <span class="inlinecode"><span class="id" type="var">t2</span></span> are tactics, then <span class="inlinecode"><span class="id" type="var">t1</span>;</span> <span class="inlinecode"><span class="id" type="var">t2</span></span> is a tactic that
    executes <span class="inlinecode"><span class="id" type="var">t1</span></span>, and then executes <span class="inlinecode"><span class="id" type="var">t2</span></span> on subgoals left by or
    newly generated by <span class="inlinecode"><span class="id" type="var">t1</span></span>.  This can help to eliminate
    repetitious use of tactics.  Two idiomatic uses are
    performing <span class="inlinecode"><span class="id" type="tactic">subst</span></span> after <span class="inlinecode"><span class="id" type="tactic">inversion</span></span> and performing <span class="inlinecode"><span class="id" type="tactic">intros</span></span>
    after <span class="inlinecode"><span class="id" type="tactic">induction</span></span>.  More opportunities to use this tactical
    can usually be discovered after writing a proof.  (It is
    worth noting that some uses of this tactical can make proofs
    less readable or more difficult to maintain.  Alternatively,
    some uses can make proofs more readable or easier to
    maintain.  It is always good to think about your priorities
    when writing a proof script.)

<div class="paragraph"> </div>

    Revise the proof for <span class="inlinecode"><span class="id" type="var">value_is_normal_form</span></span> to include uses
    of the <span class="inlinecode">;</span> tactical.

<div class="paragraph"> </div>

<a name="lab132"></a><h3 class="section">Example</h3>

    Sometimes it is helpful to be able to use forward reasoning
    in a proof.  One form of forward reasoning can be done with
    the tactic <span class="inlinecode"><span class="id" type="tactic">assert</span></span>.  <span class="inlinecode"><span class="id" type="tactic">assert</span></span> adds a new hypothesis to the
    context but asks us to first justify it.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">nvalue_is_normal_form</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">nvalue</span> <span class="id" type="var">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">normal_form</span> <span class="id" type="var">v</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">v</span> <span class="id" type="var">Hnv</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">value</span> <span class="id" type="var">v</span>) <span class="id" type="keyword">as</span> <span class="id" type="var">Hv</span>. <span class="id" type="tactic">right</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">Hnv</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">value_is_normal_form</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">Hv</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab133"></a><h3 class="section">Example</h3>

    <span class="inlinecode"><span class="id" type="tactic">assert</span></span> can also be supplied with a tactic that proves the
    assertion.  We rewrite the above proof using this form.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">nvalue_is_normal_form'</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">nvalue</span> <span class="id" type="var">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">normal_form</span> <span class="id" type="var">v</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">v</span> <span class="id" type="var">Hnv</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">value</span> <span class="id" type="var">v</span>) <span class="id" type="keyword">as</span> <span class="id" type="var">Hv</span> <span class="id" type="tactic">by</span> (<span class="id" type="tactic">right</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Hnv</span>).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">value_is_normal_form</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">Hv</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab134"></a><h3 class="section">Example</h3>

    The proof below introduces two new, simple tactics.  First,
    the tactic <span class="inlinecode"><span class="id" type="tactic">replace</span></span> <span class="inlinecode"><span class="id" type="var">e1</span></span> <span class="inlinecode"><span class="id" type="keyword">with</span></span> <span class="inlinecode"><span class="id" type="var">e2</span></span> performs a substitution in
    the goal and then requires that you prove <span class="inlinecode"><span class="id" type="var">e2</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" type="var">e1</span></span> as a new
    subgoal.  This often allows us to avoid more cumbersome
    forms of forward reasoning.  Second, the <span class="inlinecode"><span class="id" type="tactic">clear</span></span> tactic
    discards a hypothesis from the context.  Of course, this
    tactic is never needed, but it can be nice to use when there
    are complicated, irrelevant hypotheses in the context.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">single_step_to_multi_step_determinacy</span> :<br/>
&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">u1</span> <span class="id" type="var">u2</span>, <span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">u1</span> -&gt; <span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">u2</span> -&gt; <span class="id" type="var">u1</span> = <span class="id" type="var">u2</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">v1</span> <span class="id" type="var">v2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">v1</span> -&gt; <span class="id" type="var">normal_form</span> <span class="id" type="var">v1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">v2</span> -&gt; <span class="id" type="var">normal_form</span> <span class="id" type="var">v2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">v1</span> = <span class="id" type="var">v2</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">H</span> <span class="id" type="var">t</span> <span class="id" type="var">v1</span> <span class="id" type="var">v2</span> <span class="id" type="var">Hm1</span> <span class="id" type="var">Hnf1</span> <span class="id" type="var">Hm2</span> <span class="id" type="var">Hnf2</span>. <span class="id" type="tactic">induction</span> <span class="id" type="var">Hm1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">Hm2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">Hnf1</span>. <span class="id" type="tactic">exists</span> <span class="id" type="var">t'</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">Hm2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">Hnf2</span>. <span class="id" type="tactic">exists</span> <span class="id" type="var">t'</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHHm1</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">IHHm1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Hnf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">replace</span> <span class="id" type="var">t'</span> <span class="id" type="keyword">with</span> <span class="id" type="var">t'0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Hm2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">H</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">t</span> := <span class="id" type="var">t</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">H0</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab135"></a><h3 class="section">Exercise</h3>

    This proof is lengthy and thus somewhat challenging.  All of
    the techniques from this section will be useful; some will
    be essential.  In particular, you will need to use
    <span class="inlinecode"><span class="id" type="tactic">generalize</span></span> <span class="inlinecode"><span class="id" type="tactic">dependent</span></span> at the beginning of the proof.  You
    will find <span class="inlinecode"><span class="id" type="tactic">assert</span></span> helpful in the cases where your
    assumptions are contradictory but none of them are in a
    negative form.  In that situation, you can assert a negative
    statement that follows from your hypotheses (recall that
    <span class="inlinecode"><span class="id" type="var">normal_form</span></span> is a negative statement).  Finally, you will
    want to use the above lemma <span class="inlinecode"><span class="id" type="var">nvalue_is_normal_form</span></span>.  Good
    luck!

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Theorem</span> <span class="id" type="var">eval_deterministic</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span class="id" type="var">t''</span>,<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">t''</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">t'</span> = <span class="id" type="var">t''</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab136"></a><h3 class="section">Exercise</h3>

    Prove the following lemmas.  The last is quite long, and you
    may wish to wait until you know more about automation.
<pre>
Lemma full_eval_from_value : forall v w,
  value v -&gt;
  full_eval v w -&gt;
  v = w.

Lemma eval_full_eval : forall t t' v,
  eval t t' -&gt;
  full_eval t' v -&gt;
  full_eval t v.

Lemma full_eval_complete : forall t v,
  value v -&gt;
  eval_many t v -&gt;
  full_eval t v.
</pre>

<div class="paragraph"> </div>

<a name="lab137"></a><h2 class="section">Basic Automation</h2>


<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" type="tactic">eapply</span></span>, <span class="inlinecode"><span class="id" type="var">esplit</span></span>

</li>
<li> <span class="inlinecode"><span class="id" type="tactic">auto</span></span>, <span class="inlinecode"><span class="id" type="tactic">eauto</span></span>

</li>
</ul>

<div class="paragraph"> </div>

<a name="lab138"></a><h3 class="section">Example</h3>

    You can use <span class="inlinecode"><span class="id" type="tactic">eapply</span></span> <span class="inlinecode"><span class="id" type="var">e</span></span> instead of <span class="inlinecode"><span class="id" type="tactic">apply</span></span> <span class="inlinecode"><span class="id" type="var">e</span></span> <span class="inlinecode"><span class="id" type="keyword">with</span></span> <span class="inlinecode">(<span class="id" type="var">x</span></span> <span class="inlinecode">:=</span> <span class="inlinecode"><span class="id" type="var">e1</span>)</span>.
    This will generate subgoals containing unification variables
    that will get unified during subsequent uses of <span class="inlinecode"><span class="id" type="tactic">apply</span></span>.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">m_if</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t1</span> <span class="id" type="var">u1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t1</span> <span class="id" type="var">u1</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> (<span class="id" type="var">tm_if</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>) (<span class="id" type="var">tm_if</span> <span class="id" type="var">u1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t1</span> <span class="id" type="var">u1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span> <span class="id" type="var">Hm</span>. <span class="id" type="tactic">induction</span> <span class="id" type="var">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_refl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <span class="id" type="var">m_step</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">e_if</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHHm</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab139"></a><h3 class="section">Example</h3>

    You can use <span class="inlinecode"><span class="id" type="var">esplit</span></span> to turn an existentially quantified
    variable in your goal into a unification variable.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">exists_pred_zero</span> :<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exists</span> <span class="id" type="var">u</span>, <span class="id" type="tactic">eval</span> (<span class="id" type="var">tm_pred</span> <span class="id" type="var">tm_zero</span>) <span class="id" type="var">u</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">esplit</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">e_predzero</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab140"></a><h3 class="section">Example</h3>

    The <span class="inlinecode"><span class="id" type="tactic">auto</span></span> tactic solves goals that are solvable by any
    combination of

<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" type="tactic">intros</span></span>

</li>
<li> <span class="inlinecode"><span class="id" type="tactic">apply</span></span> (used on some local hypothesis)

</li>
<li> <span class="inlinecode"><span class="id" type="tactic">split</span></span>, <span class="inlinecode"><span class="id" type="tactic">left</span></span>, <span class="inlinecode"><span class="id" type="tactic">right</span></span>

</li>
<li> <span class="inlinecode"><span class="id" type="tactic">reflexivity</span></span>

</li>
</ul>
    If <span class="inlinecode"><span class="id" type="tactic">auto</span></span> cannot solve the goal, it will leave the proof
    state completely unchanged (without generating any errors).

<div class="paragraph"> </div>

    The lemma below is a proposition that has been contrived for
    the sake of demonstrating the scope of the <span class="inlinecode"><span class="id" type="tactic">auto</span></span> tactic and
    does not say anything of practical interest.  So instead of
    thinking about what it means, you should think about the
    operations that <span class="inlinecode"><span class="id" type="tactic">auto</span></span> had to perform to solve the goal.

<div class="paragraph"> </div>

    Note: It is important to remember that <span class="inlinecode"><span class="id" type="tactic">auto</span></span> does not
    destruct hypotheses!  There are more advanced forms of
    automation available that do destruct hypotheses in some
    specific ways.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">auto_example</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span class="id" type="var">t''</span>,<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t'</span> <span class="id" type="var">t''</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> <span class="id" type="var">u</span>, <span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> -&gt; <span class="id" type="tactic">eval</span> <span class="id" type="var">t'</span> <span class="id" type="var">u</span> -&gt; <span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t'</span> <span class="id" type="var">t</span> \/ <span class="id" type="var">t</span> = <span class="id" type="var">t</span> /\ <span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">t''</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab141"></a><h3 class="section">Example</h3>

    The <span class="inlinecode"><span class="id" type="tactic">eauto</span></span> tactic solves goals that are solvable by some
    combination of

<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" type="tactic">intros</span></span>

</li>
<li> <span class="inlinecode"><span class="id" type="tactic">eapply</span></span> (used on some local hypothesis)

</li>
<li> <span class="inlinecode"><span class="id" type="tactic">split</span></span>, <span class="inlinecode"><span class="id" type="tactic">left</span></span>, <span class="inlinecode"><span class="id" type="tactic">right</span></span>

</li>
<li> <span class="inlinecode"><span class="id" type="var">esplit</span></span>

</li>
<li> <span class="inlinecode"><span class="id" type="tactic">reflexivity</span></span>

</li>
</ul>
    This lemma has two significantly differences from the
    previous one, both of which render <span class="inlinecode"><span class="id" type="tactic">auto</span></span> useless.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">eauto_example</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span class="id" type="var">t''</span>,<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t'</span> <span class="id" type="var">t''</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> <span class="id" type="var">u</span>, <span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span> -&gt; <span class="id" type="tactic">eval</span> <span class="id" type="var">u</span> <span class="id" type="var">t''</span> -&gt; <span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">t''</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t'</span> <span class="id" type="var">t</span> \/ (<span class="id" type="tactic">exists</span> <span class="id" type="var">u</span>, <span class="id" type="var">t</span> = <span class="id" type="var">u</span>) /\ <span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">t''</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eauto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab142"></a><h3 class="section">Example</h3>

    You can enhance <span class="inlinecode"><span class="id" type="tactic">auto</span></span> (or <span class="inlinecode"><span class="id" type="tactic">eauto</span></span>) by appending <span class="inlinecode"><span class="id" type="keyword">using</span></span> <span class="inlinecode"><span class="id" type="var">x_1</span>,</span>
    <span class="inlinecode">...,</span> <span class="inlinecode"><span class="id" type="var">x_n</span></span>, where each <span class="inlinecode"><span class="id" type="var">x_i</span></span> is the name of some constructor
    or lemma.  Then <span class="inlinecode"><span class="id" type="tactic">auto</span></span> will attempt to apply those
    constructors or lemmas in addition to the assumptions in
    the local context.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">eauto_using_example</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span class="id" type="var">t''</span>,<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t'</span> <span class="id" type="var">t''</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t'</span> <span class="id" type="var">t</span> \/ <span class="id" type="var">t</span> = <span class="id" type="var">t</span> /\ <span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">t''</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eauto</span> <span class="id" type="keyword">using</span> <span class="id" type="var">m_step</span>, <span class="id" type="var">m_one</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<a name="lab143"></a><h3 class="section">Exercise</h3>

    Go back and rewrite your proofs for <span class="inlinecode"><span class="id" type="var">m_one</span></span>, <span class="inlinecode"><span class="id" type="var">m_two</span></span>, and
    <span class="inlinecode"><span class="id" type="var">m_iftrue_step</span></span>.  You should be able to make them very
    succinct given what you know now.

<div class="paragraph"> </div>

<a name="lab144"></a><h3 class="section">Exercise</h3>

    See how short you can make these proofs.

<div class="paragraph"> </div>

    Note: This is an exercise.  We are not making the claim that
    shorter proofs are necessarily better!

<div class="paragraph"> </div>

    Hint: Remember that we can connect tactics in sequence with
    <span class="inlinecode">;</span>.  However, as you can imagine, figuring out the best
    thing to write after a <span class="inlinecode">;</span> usually involves some trial and
    error.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">pred_not_circular</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">t</span> &lt;&gt; <span class="id" type="var">tm_pred</span> <span class="id" type="var">t</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">m_succ</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span>) (<span class="id" type="var">tm_succ</span> <span class="id" type="var">u</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">m_pred</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> (<span class="id" type="var">tm_pred</span> <span class="id" type="var">t</span>) (<span class="id" type="var">tm_pred</span> <span class="id" type="var">u</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab145"></a><h3 class="section">Exercise</h3>

    Go back and rewrite your proofs for <span class="inlinecode"><span class="id" type="var">m_trans</span></span> and
    <span class="inlinecode"><span class="id" type="var">two_values</span></span>.  Pulling together several tricks you've
    learned, you should be able to prove <span class="inlinecode"><span class="id" type="var">two_values</span></span> in one
    (short) line.

<div class="paragraph"> </div>

<a name="lab146"></a><h3 class="section">Note</h3>

    Sometimes there are lemmas or constructors that are so
    frequently needed by <span class="inlinecode"><span class="id" type="tactic">auto</span></span> that we don't want to have to
    add them to our <span class="inlinecode"><span class="id" type="keyword">using</span></span> clause each time.  Coq allows us to
    request that certain propositions that always be
    considered by <span class="inlinecode"><span class="id" type="tactic">auto</span></span> and <span class="inlinecode"><span class="id" type="tactic">eauto</span></span>.

<div class="paragraph"> </div>

    The following command adds four lemmas to the default search
    procedure of <span class="inlinecode"><span class="id" type="tactic">auto</span></span>.

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Hint Resolve</span> <span class="id" type="var">m_if</span> <span class="id" type="var">m_succ</span> <span class="id" type="var">m_pred</span> <span class="id" type="var">m_iszero</span>.<br/>

<br/>
</div>

<div class="doc">
Constructors of inductively defined propositions are some of
    the most frequently needed by <span class="inlinecode"><span class="id" type="tactic">auto</span></span>.  Instead of writing
<pre>
    Hint Resolve b_true b_false.
</pre>
    we may simply write
<pre>
    Hint Constructors bvalue.
</pre>
    Let's add all our constructors to <span class="inlinecode"><span class="id" type="tactic">auto</span></span>.

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Hint Constructors</span> <span class="id" type="var">bvalue</span> <span class="id" type="var">nvalue</span> <span class="id" type="tactic">eval</span> <span class="id" type="var">eval_many</span>.<br/>

<br/>
</div>

<div class="doc">
By default <span class="inlinecode"><span class="id" type="tactic">auto</span></span> will never try to unfold definitions to
    see if a lemma or constructor can be applied.  With the
    <span class="inlinecode"><span class="id" type="keyword">Hint</span></span> <span class="inlinecode"><span class="id" type="keyword">Unfold</span></span> command, we can instruct <span class="inlinecode"><span class="id" type="tactic">auto</span></span> to try unfold
    definitions in the goal as it is working.

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Hint Unfold</span> <span class="id" type="var">value</span> <span class="id" type="var">normal_form</span>.<br/>

<br/>
</div>

<div class="doc">
There are a few more variants on the <span class="inlinecode"><span class="id" type="keyword">Hint</span></span> command that can
    be used to further customize <span class="inlinecode"><span class="id" type="tactic">auto</span></span>.  You can learn about
    them in the Coq reference manual.

<div class="paragraph"> </div>

<a name="lab147"></a><h2 class="section">Functions and Conversion</h2>


<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" type="keyword">Fixpoint</span>/<span class="id" type="keyword">struct</span></span>

</li>
<li> <span class="inlinecode"><span class="id" type="keyword">match</span></span> <span class="inlinecode">...</span> <span class="inlinecode"><span class="id" type="keyword">end</span></span>

</li>
<li> <span class="inlinecode"><span class="id" type="keyword">if</span></span> <span class="inlinecode">...</span> <span class="inlinecode"><span class="id" type="keyword">then</span></span> <span class="inlinecode">...</span> <span class="inlinecode"><span class="id" type="keyword">else</span></span> <span class="inlinecode">...</span>

</li>
<li> <span class="inlinecode"><span class="id" type="tactic">simpl</span></span>

</li>
<li> <span class="inlinecode"><span class="id" type="var">remember</span></span>

</li>
</ul>
    In this section we start to use Coq as a programming
    language and learn how to reason about programs defined
    within Coq.

<div class="paragraph"> </div>

<a name="lab148"></a><h3 class="section">Example</h3>

    Coq defines many datatypes in its standard libraries.  Have
    a quick look now through the library <span class="inlinecode"><span class="id" type="var">Datatypes</span></span> to see some
    of the basic ones, in particular <span class="inlinecode"><span class="id" type="var">bool</span></span> and <span class="inlinecode"><span class="id" type="var">nat</span></span>.  (Note
    that constructors of the datatype <span class="inlinecode"><span class="id" type="var">nat</span></span> are the letter <span class="inlinecode"><span class="id" type="var">O</span></span>
    and the letter <span class="inlinecode"><span class="id" type="var">S</span></span>.  However, Coq will parse and print
    <span class="inlinecode"><span class="id" type="var">nat</span></span>s using a standard decimal representation.)

<div class="paragraph"> </div>

    We define two more datatypes here that will be useful later.

</div>
<div class="code">
<span class="id" type="keyword">Inductive</span> <span class="id" type="var">bool_option</span> : <span class="id" type="keyword">Set</span> :=<br/>
| <span class="id" type="var">some_bool</span> : <span class="id" type="var">bool</span> -&gt; <span class="id" type="var">bool_option</span><br/>
| <span class="id" type="var">no_bool</span> : <span class="id" type="var">bool_option</span>.<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <span class="id" type="var">nat_option</span> : <span class="id" type="keyword">Set</span> :=<br/>
| <span class="id" type="var">some_nat</span> : <span class="id" type="var">nat</span> -&gt; <span class="id" type="var">nat_option</span><br/>
| <span class="id" type="var">no_nat</span> : <span class="id" type="var">nat_option</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab149"></a><h3 class="section">Example</h3>

    We can define simple (non-recursive) functions from one
    datatype to another using the <span class="inlinecode"><span class="id" type="keyword">Definition</span></span> keyword.  The
    <span class="inlinecode"><span class="id" type="keyword">match</span></span> construct allows us to do case analysis on a
    datatype.  The <span class="inlinecode"><span class="id" type="keyword">match</span></span> expression has a first-match
    semantics and allows nested patterns; however, Coq's type
    checker demands that pattern-matching be exhaustive.

<div class="paragraph"> </div>

    We define functions below for converting between Coq <span class="inlinecode"><span class="id" type="var">bool</span></span>s
    and boolean values in our object language.

</div>
<div class="code">
<span class="id" type="keyword">Definition</span> <span class="id" type="var">tm_to_bool</span> (<span class="id" type="var">t</span> : <span class="id" type="var">tm</span>) : <span class="id" type="var">bool_option</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">t</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">tm_true</span> =&gt; <span class="id" type="var">some_bool</span> <span class="id" type="var">true</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">tm_false</span> =&gt; <span class="id" type="var">some_bool</span> <span class="id" type="var">false</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <span class="id" type="var">no_bool</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">bool_to_tm</span> (<span class="id" type="var">b</span> : <span class="id" type="var">bool</span>) : <span class="id" type="var">tm</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">b</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">true</span> =&gt; <span class="id" type="var">tm_true</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">false</span> =&gt; <span class="id" type="var">tm_false</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab150"></a><h3 class="section">Example</h3>

    Coq also has an <span class="inlinecode"><span class="id" type="keyword">if</span>/<span class="id" type="keyword">then</span>/<span class="id" type="keyword">else</span></span> expression.  It can be used,
    not just with the type <span class="inlinecode"><span class="id" type="var">bool</span></span> but, in fact, with any
    datatype having exactly two constructors (the first
    constructor corresponding to the <span class="inlinecode"><span class="id" type="keyword">then</span></span> branch and the
    second to the <span class="inlinecode"><span class="id" type="keyword">else</span></span> branch).  Thus, we can define a
    function <span class="inlinecode"><span class="id" type="var">is_bool</span></span> as below.

</div>
<div class="code">
<span class="id" type="keyword">Definition</span> <span class="id" type="var">is_bool</span> (<span class="id" type="var">t</span> : <span class="id" type="var">tm</span>) : <span class="id" type="var">bool</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">if</span> <span class="id" type="var">tm_to_bool</span> <span class="id" type="var">t</span> <span class="id" type="keyword">then</span> <span class="id" type="var">true</span> <span class="id" type="keyword">else</span> <span class="id" type="var">false</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab151"></a><h3 class="section">Example</h3>

    To define a recursive function, use <span class="inlinecode"><span class="id" type="keyword">Fixpoint</span></span> instead of
    <span class="inlinecode"><span class="id" type="keyword">Definition</span></span>.

<div class="paragraph"> </div>

    The type system will only allow us to write functions that
    terminate.  The annotation <span class="inlinecode">{<span class="id" type="keyword">struct</span></span> <span class="inlinecode"><span class="id" type="var">t</span>}</span> here informs the
    type-checker that termination is guaranteed because the
    function is being defined by structural recursion on <span class="inlinecode"><span class="id" type="var">t</span></span>.

</div>
<div class="code">
<span class="id" type="keyword">Fixpoint</span> <span class="id" type="var">tm_to_nat</span> (<span class="id" type="var">t</span> : <span class="id" type="var">tm</span>) {<span class="id" type="keyword">struct</span> <span class="id" type="var">t</span>} : <span class="id" type="var">nat_option</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">t</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">tm_zero</span> =&gt; <span class="id" type="var">some_nat</span> <span class="id" type="var">O</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">tm_succ</span> <span class="id" type="var">t1</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">tm_to_nat</span> <span class="id" type="var">t1</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">some_nat</span> <span class="id" type="var">n</span> =&gt; <span class="id" type="var">some_nat</span> (<span class="id" type="var">S</span> <span class="id" type="var">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">no_nat</span> =&gt; <span class="id" type="var">no_nat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <span class="id" type="var">no_nat</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Fixpoint</span> <span class="id" type="var">nat_to_tm</span> (<span class="id" type="var">n</span> : <span class="id" type="var">nat</span>) {<span class="id" type="keyword">struct</span> <span class="id" type="var">n</span>} : <span class="id" type="var">tm</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">n</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">O</span> =&gt; <span class="id" type="var">tm_zero</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">S</span> <span class="id" type="var">m</span> =&gt; <span class="id" type="var">tm_succ</span> (<span class="id" type="var">nat_to_tm</span> <span class="id" type="var">m</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab152"></a><h3 class="section">Exercise</h3>

    Write a function <span class="inlinecode"><span class="id" type="var">interp</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" type="var">tm</span></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><span class="id" type="var">tm</span></span> that returns the
    normal form of its argument according to the small-step
    semantics given by <span class="inlinecode"><span class="id" type="tactic">eval</span></span>.

<div class="paragraph"> </div>

    Hint: You will want to use <span class="inlinecode"><span class="id" type="var">tm_to_nat</span></span> (or another auxiliary
    function) to prevent stuck terms from stepping in the cases
    <span class="inlinecode"><span class="id" type="var">e_predsucc</span></span> and <span class="inlinecode"><span class="id" type="var">e_iszerosucc</span></span>.

<div class="paragraph"> </div>

<a name="lab153"></a><h3 class="section">Example</h3>

    The tactic <span class="inlinecode"><span class="id" type="tactic">simpl</span></span> (recursively) reduces the application of
    a function defined by pattern-matching to an argument with a
    constructor at its head.  You can supply <span class="inlinecode"><span class="id" type="tactic">simpl</span></span> with a
    particular expression if you want to prevent it from
    simplifying elsewhere.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">bool_tm_bool</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">b</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">tm_to_bool</span> (<span class="id" type="var">bool_to_tm</span> <span class="id" type="var">b</span>) = <span class="id" type="var">some_bool</span> <span class="id" type="var">b</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">b</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> (<span class="id" type="var">bool_to_tm</span> <span class="id" type="var">true</span>). <span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab154"></a><h3 class="section">Example</h3>

    We can also apply the tactic <span class="inlinecode"><span class="id" type="tactic">simpl</span></span> in our hypotheses.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">tm_bool_tm</span> :<span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">b</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">tm_to_bool</span> <span class="id" type="var">t</span> = <span class="id" type="var">some_bool</span> <span class="id" type="var">b</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">bool_to_tm</span> <span class="id" type="var">b</span> = <span class="id" type="var">t</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">b</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab155"></a><h3 class="section">Exercise</h3>

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">tm_to_bool_dom_includes_bvalue</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">bv</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">bvalue</span> <span class="id" type="var">bv</span> -&gt; <span class="id" type="tactic">exists</span> <span class="id" type="var">b</span>, <span class="id" type="var">tm_to_bool</span> <span class="id" type="var">bv</span> = <span class="id" type="var">some_bool</span> <span class="id" type="var">b</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab156"></a><h3 class="section">Exercise</h3>

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">tm_to_bool_dom_only_bvalue</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">bv</span> <span class="id" type="var">b</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">tm_to_bool</span> <span class="id" type="var">bv</span> = <span class="id" type="var">some_bool</span> <span class="id" type="var">b</span> -&gt; <span class="id" type="var">bvalue</span> <span class="id" type="var">bv</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab157"></a><h3 class="section">Example</h3>

    Not all uses of <span class="inlinecode"><span class="id" type="tactic">simpl</span></span> are optional.  Sometimes they are
    necessary so that we can use the <span class="inlinecode"><span class="id" type="tactic">rewrite</span></span> tactic.  Observe,
    also, how using <span class="inlinecode"><span class="id" type="tactic">rewrite</span></span> can automatically trigger a
    reduction if it creates a redex.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">nat_tm_nat</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">n</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">tm_to_nat</span> (<span class="id" type="var">nat_to_tm</span> <span class="id" type="var">n</span>) = <span class="id" type="var">some_nat</span> <span class="id" type="var">n</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">n</span>. <span class="id" type="tactic">induction</span> <span class="id" type="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">rewrite</span> -&gt; <span class="id" type="var">IHn</span>. <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab158"></a><h3 class="section">Example</h3>

    Here's an example where it is necessary to use <span class="inlinecode"><span class="id" type="tactic">simpl</span></span> on a
    hypothesis.  To trigger a reduction of a <span class="inlinecode"><span class="id" type="keyword">match</span></span> expression
    in a hypothesis, we use the <span class="inlinecode"><span class="id" type="tactic">destruct</span></span> tactic on the
    expression being matched.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">tm_nat_tm</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">n</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">tm_to_nat</span> <span class="id" type="var">t</span> = <span class="id" type="var">some_nat</span> <span class="id" type="var">n</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">nat_to_tm</span> <span class="id" type="var">n</span> = <span class="id" type="var">t</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span>. <span class="id" type="tactic">induction</span> <span class="id" type="var">t</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">n</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">destruct</span> (<span class="id" type="var">tm_to_nat</span> <span class="id" type="var">t</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">rewrite</span> -&gt; <span class="id" type="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab159"></a><h3 class="section">Exercise</h3>

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">tm_to_nat_dom_includes_nvalue</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">nvalue</span> <span class="id" type="var">v</span> -&gt; <span class="id" type="tactic">exists</span> <span class="id" type="var">n</span>, <span class="id" type="var">tm_to_nat</span> <span class="id" type="var">v</span> = <span class="id" type="var">some_nat</span> <span class="id" type="var">n</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab160"></a><h3 class="section">Exercise</h3>

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">tm_to_nat_dom_only_nvalue</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">v</span> <span class="id" type="var">n</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">tm_to_nat</span> <span class="id" type="var">v</span> = <span class="id" type="var">some_nat</span> <span class="id" type="var">n</span> -&gt; <span class="id" type="var">nvalue</span> <span class="id" type="var">v</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab161"></a><h3 class="section">Example</h3>

    Using the tactic <span class="inlinecode"><span class="id" type="tactic">destruct</span></span> (or <span class="inlinecode"><span class="id" type="tactic">induction</span></span>) on a complex
    expression (i.e., one that is not simply a variable) may not
    leave you with enough information for you to finish the
    proof.  The tactic <span class="inlinecode"><span class="id" type="var">remember</span></span> can help in these cases.  Its
    usage is demonstrated below.  If you are curious, try to
    finish the proof without <span class="inlinecode"><span class="id" type="var">remember</span></span> to see what goes wrong.

</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">remember_example</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">tm_pred</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">v</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">match</span> <span class="id" type="var">tm_to_nat</span> <span class="id" type="var">v</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">some_nat</span> <span class="id" type="var">_</span> =&gt; <span class="id" type="var">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">no_nat</span> =&gt; <span class="id" type="var">tm_pred</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">v</span>. <span class="id" type="var">remember</span> (<span class="id" type="var">tm_to_nat</span> <span class="id" type="var">v</span>) <span class="id" type="keyword">as</span> <span class="id" type="var">x</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_one</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">e_predsucc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <span class="id" type="var">tm_to_nat_dom_only_nvalue</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">Heqx</span>. <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_refl</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab162"></a><h3 class="section">Exercise</h3>

    Prove the following lemmas involving the function <span class="inlinecode"><span class="id" type="var">interp</span></span>
    from a previous exercise:
<pre>
Lemma interp_reduces : forall t,
  eval_many t (interp t).

Lemma interp_fully_reduces : forall t,
  normal_form (interp t).
</pre>

<div class="paragraph"> </div>

<a name="lab163"></a><h1 class="section">Solutions to Exercises</h1>

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Inductive</span> <span class="id" type="var">eval_rtc</span> : <span class="id" type="var">tm</span> -&gt; <span class="id" type="var">tm</span> -&gt; <span class="id" type="keyword">Prop</span> :=<br/>
| <span class="id" type="var">r_eval</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">eval_rtc</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span><br/>
| <span class="id" type="var">r_refl</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">eval_rtc</span> <span class="id" type="var">t</span> <span class="id" type="var">t</span><br/>
| <span class="id" type="var">r_trans</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">eval_rtc</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">eval_rtc</span> <span class="id" type="var">u</span> <span class="id" type="var">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">eval_rtc</span> <span class="id" type="var">t</span> <span class="id" type="var">v</span>.<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <span class="id" type="var">full_eval</span> : <span class="id" type="var">tm</span> -&gt; <span class="id" type="var">tm</span> -&gt; <span class="id" type="keyword">Prop</span> :=<br/>
| <span class="id" type="var">f_value</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">value</span> <span class="id" type="var">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">full_eval</span> <span class="id" type="var">v</span> <span class="id" type="var">v</span><br/>
| <span class="id" type="var">f_iftrue</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">full_eval</span> <span class="id" type="var">t1</span> <span class="id" type="var">tm_true</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">full_eval</span> <span class="id" type="var">t2</span> <span class="id" type="var">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">full_eval</span> (<span class="id" type="var">tm_if</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>) <span class="id" type="var">v</span><br/>
| <span class="id" type="var">f_iffalse</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">full_eval</span> <span class="id" type="var">t1</span> <span class="id" type="var">tm_false</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">full_eval</span> <span class="id" type="var">t3</span> <span class="id" type="var">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">full_eval</span> (<span class="id" type="var">tm_if</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>) <span class="id" type="var">v</span><br/>
| <span class="id" type="var">f_succ</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">nvalue</span> <span class="id" type="var">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">full_eval</span> <span class="id" type="var">t</span> <span class="id" type="var">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">full_eval</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span>) (<span class="id" type="var">tm_succ</span> <span class="id" type="var">v</span>)<br/>
| <span class="id" type="var">f_predzero</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">full_eval</span> <span class="id" type="var">t</span> <span class="id" type="var">tm_zero</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">full_eval</span> (<span class="id" type="var">tm_pred</span> <span class="id" type="var">t</span>) <span class="id" type="var">tm_zero</span><br/>
| <span class="id" type="var">f_predsucc</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">nvalue</span> <span class="id" type="var">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">full_eval</span> <span class="id" type="var">t</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">v</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">full_eval</span> (<span class="id" type="var">tm_pred</span> <span class="id" type="var">t</span>) <span class="id" type="var">v</span><br/>
| <span class="id" type="var">f_iszerozero</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">full_eval</span> <span class="id" type="var">t</span> <span class="id" type="var">tm_zero</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">full_eval</span> (<span class="id" type="var">tm_iszero</span> <span class="id" type="var">t</span>) <span class="id" type="var">tm_true</span><br/>
| <span class="id" type="var">f_iszerosucc</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">nvalue</span> <span class="id" type="var">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">full_eval</span> <span class="id" type="var">t</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">v</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">full_eval</span> (<span class="id" type="var">tm_iszero</span> <span class="id" type="var">t</span>) <span class="id" type="var">tm_false</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">m_one_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span>,<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span class="id" type="var">He</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">m_step</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">t'</span> := <span class="id" type="var">t'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">He</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_refl</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">m_two_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span class="id" type="var">t''</span>,<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t'</span> <span class="id" type="var">t''</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">t''</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span class="id" type="var">t''</span> <span class="id" type="var">He1</span> <span class="id" type="var">He2</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">m_step</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">t'</span> := <span class="id" type="var">t'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">He1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_one</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">He2</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">m_iftrue_step_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">u</span>,<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">tm_true</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t1</span> <span class="id" type="var">u</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> (<span class="id" type="var">tm_if</span> <span class="id" type="var">t</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>) <span class="id" type="var">u</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">u</span> <span class="id" type="var">He</span> <span class="id" type="var">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_step</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">t'</span> := <span class="id" type="var">tm_if</span> <span class="id" type="var">tm_true</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">e_if</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">He</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_step</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">t'</span> := <span class="id" type="var">t1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">e_iftrue</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Hm</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">m_if_iszero_conj_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">v</span> <span class="id" type="var">t2</span> <span class="id" type="var">t2'</span> <span class="id" type="var">t3</span> <span class="id" type="var">t3'</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">nvalue</span> <span class="id" type="var">v</span> /\ <span class="id" type="tactic">eval</span> <span class="id" type="var">t2</span> <span class="id" type="var">t2'</span> /\ <span class="id" type="tactic">eval</span> <span class="id" type="var">t3</span> <span class="id" type="var">t3'</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> (<span class="id" type="var">tm_if</span> (<span class="id" type="var">tm_iszero</span> <span class="id" type="var">tm_zero</span>) <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>) <span class="id" type="var">t2'</span> /\<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> (<span class="id" type="var">tm_if</span> (<span class="id" type="var">tm_iszero</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">v</span>)) <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>) <span class="id" type="var">t3'</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">v</span> <span class="id" type="var">t2</span> <span class="id" type="var">t2'</span> <span class="id" type="var">t3</span> <span class="id" type="var">t3'</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [ <span class="id" type="var">Hn</span> [ <span class="id" type="var">He1</span> <span class="id" type="var">He2</span> ] ]. <span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_three</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">t'</span> := <span class="id" type="var">tm_if</span> <span class="id" type="var">tm_true</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>) (<span class="id" type="var">t''</span> := <span class="id" type="var">t2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">e_if</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">e_iszerozero</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">e_iftrue</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">He1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_three</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">t'</span> := <span class="id" type="var">tm_if</span> <span class="id" type="var">tm_false</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>) (<span class="id" type="var">t''</span> := <span class="id" type="var">t3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">e_if</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">e_iszerosucc</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">Hn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">e_iffalse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">He2</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">two_values_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">value</span> <span class="id" type="var">t</span> /\ <span class="id" type="var">value</span> <span class="id" type="var">u</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">bvalue</span> <span class="id" type="var">t</span> \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">bvalue</span> <span class="id" type="var">u</span> \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">nvalue</span> <span class="id" type="var">t</span> /\ <span class="id" type="var">nvalue</span> <span class="id" type="var">u</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">value</span>. <span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [ [ <span class="id" type="var">Hb1</span> | <span class="id" type="var">Hn1</span> ] <span class="id" type="var">H2</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">left</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">Hb1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">H2</span> <span class="id" type="keyword">as</span> [ <span class="id" type="var">Hb2</span> | <span class="id" type="var">Hn2</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">right</span>. <span class="id" type="tactic">left</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">Hb2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">right</span>. <span class="id" type="tactic">right</span>. <span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Hn1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Hn2</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">m_trans_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">u</span> <span class="id" type="var">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">v</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span> <span class="id" type="var">v</span> <span class="id" type="var">Hm1</span> <span class="id" type="var">Hm2</span>. <span class="id" type="tactic">induction</span> <span class="id" type="var">Hm1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Hm2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_step</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">t'</span> := <span class="id" type="var">t'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHHm1</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">Hm2</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">eval_rtc_many_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_rtc</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span> <span class="id" type="var">Hr</span>. <span class="id" type="tactic">induction</span> <span class="id" type="var">Hr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_one</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_refl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_trans</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">t'</span> := <span class="id" type="var">u</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHHr1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHHr2</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">eval_many_rtc_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_rtc</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span> <span class="id" type="var">Hm</span>. <span class="id" type="tactic">induction</span> <span class="id" type="var">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">r_refl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">r_trans</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">u</span> := <span class="id" type="var">t'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">r_eval</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHHm</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">full_eval_to_value_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">full_eval</span> <span class="id" type="var">t</span> <span class="id" type="var">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">value</span> <span class="id" type="var">v</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">v</span> <span class="id" type="var">Hf</span>. <span class="id" type="tactic">induction</span> <span class="id" type="var">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHHf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHHf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">right</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">n_succ</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">right</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">n_zero</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">right</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">left</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">b_true</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">left</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">b_false</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">value_can_expand_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">value</span> <span class="id" type="var">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exists</span> <span class="id" type="var">u</span>, <span class="id" type="tactic">eval</span> <span class="id" type="var">u</span> <span class="id" type="var">v</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">v</span> <span class="id" type="var">Hv</span>. <span class="id" type="tactic">exists</span> (<span class="id" type="var">tm_if</span> <span class="id" type="var">tm_true</span> <span class="id" type="var">v</span> <span class="id" type="var">v</span>). <span class="id" type="tactic">apply</span> <span class="id" type="var">e_iftrue</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">exists_iszero_nvalue_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;(<span class="id" type="tactic">exists</span> <span class="id" type="var">nv</span>, <span class="id" type="var">nvalue</span> <span class="id" type="var">nv</span> /\ <span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">nv</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exists</span> <span class="id" type="var">bv</span>, <span class="id" type="var">eval_many</span> (<span class="id" type="var">tm_iszero</span> <span class="id" type="var">t</span>) <span class="id" type="var">bv</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> [ <span class="id" type="var">nv</span> [ <span class="id" type="var">Hnv</span> <span class="id" type="var">Hm</span> ]]. <span class="id" type="tactic">destruct</span> <span class="id" type="var">Hnv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">exists</span> <span class="id" type="var">tm_true</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_trans</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">t'</span> := <span class="id" type="var">tm_iszero</span> <span class="id" type="var">tm_zero</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_iszero</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_one</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">e_iszerozero</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">exists</span> <span class="id" type="var">tm_false</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_trans</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">t'</span> := <span class="id" type="var">tm_iszero</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_iszero</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_one</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">e_iszerosucc</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">Hnv</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">normal_form_to_forall_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">normal_form</span> <span class="id" type="var">t</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">u</span>, ~ <span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">normal_form</span>, <span class="id" type="var">not</span>. <span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">H</span> <span class="id" type="var">u</span> <span class="id" type="var">He</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">exists</span> <span class="id" type="var">u</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">He</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">normal_form_from_forall_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> <span class="id" type="var">u</span>, ~ <span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">normal_form</span> <span class="id" type="var">t</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">normal_form</span>, <span class="id" type="var">not</span>. <span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">H</span> [ <span class="id" type="var">t'</span> <span class="id" type="var">Het'</span> ].<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">H</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">u</span> := <span class="id" type="var">t'</span>). <span class="id" type="tactic">apply</span> <span class="id" type="var">Het'</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">negation_exercise_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">v1</span> <span class="id" type="var">v2</span>,<br/>
&nbsp;&nbsp;~ (<span class="id" type="var">value</span> <span class="id" type="var">v1</span> \/ <span class="id" type="var">value</span> <span class="id" type="var">v2</span>) -&gt;<br/>
&nbsp;&nbsp;~ (~ <span class="id" type="var">bvalue</span> <span class="id" type="var">v1</span> /\ ~ <span class="id" type="var">bvalue</span> <span class="id" type="var">v2</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">tm_true</span> <span class="id" type="var">tm_false</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">v1</span> <span class="id" type="var">v2</span> <span class="id" type="var">H1</span> <span class="id" type="var">H2</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Hb</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">H1</span>. <span class="id" type="tactic">left</span>. <span class="id" type="tactic">left</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">Hb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Hb</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">H1</span>. <span class="id" type="tactic">right</span>. <span class="id" type="tactic">left</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">Hb</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">equality_exercise_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span> <span class="id" type="var">u1</span> <span class="id" type="var">u2</span> <span class="id" type="var">u3</span> <span class="id" type="var">u4</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">tm_if</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span> = <span class="id" type="var">tm_if</span> <span class="id" type="var">u1</span> <span class="id" type="var">u2</span> <span class="id" type="var">u2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">tm_if</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span> = <span class="id" type="var">tm_if</span> <span class="id" type="var">u3</span> <span class="id" type="var">u3</span> <span class="id" type="var">u4</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">t1</span> = <span class="id" type="var">u4</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span> <span class="id" type="var">u1</span> <span class="id" type="var">u2</span> <span class="id" type="var">u3</span> <span class="id" type="var">u4</span> <span class="id" type="var">Heq1</span> <span class="id" type="var">Heq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq1</span>. <span class="id" type="tactic">subst</span> <span class="id" type="var">t1</span>. <span class="id" type="tactic">subst</span> <span class="id" type="var">t2</span>. <span class="id" type="tactic">subst</span> <span class="id" type="var">t3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq2</span>. <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">succ_not_circular_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">t</span> &lt;&gt; <span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span>. <span class="id" type="tactic">induction</span> <span class="id" type="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">IHt</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">inversion_exercise_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">normal_form</span> <span class="id" type="var">t</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> (<span class="id" type="var">tm_pred</span> <span class="id" type="var">t</span>) <span class="id" type="var">tm_zero</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">nvalue</span> <span class="id" type="var">t</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">Hnf</span> <span class="id" type="var">Hm</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Hm</span>. <span class="id" type="tactic">subst</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">n_zero</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">n_succ</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">Hnf</span>. <span class="id" type="tactic">exists</span> <span class="id" type="var">t'0</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H2</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">contradictory_equalities_exercise_sol</span> :<br/>
&nbsp;&nbsp;(<span class="id" type="tactic">exists</span> <span class="id" type="var">t</span>, <span class="id" type="tactic">exists</span> <span class="id" type="var">u</span>, <span class="id" type="tactic">exists</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">value</span> <span class="id" type="var">t</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">t</span> = <span class="id" type="var">tm_succ</span> <span class="id" type="var">u</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">u</span> = <span class="id" type="var">tm_pred</span> <span class="id" type="var">v</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">tm_true</span> <span class="id" type="var">tm_false</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> [ <span class="id" type="var">t</span> [ <span class="id" type="var">u</span> [ <span class="id" type="var">v</span> [ [ <span class="id" type="var">Hb</span> | <span class="id" type="var">Hn</span> ] [ <span class="id" type="var">eq1</span> <span class="id" type="var">eq2</span> ] ] ] ] ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">Hb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">Hn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">eq1</span>. <span class="id" type="tactic">subst</span> <span class="id" type="var">t</span>. <span class="id" type="tactic">subst</span> <span class="id" type="var">u</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Hn</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">eval_fact_exercise_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> (<span class="id" type="var">tm_iszero</span> (<span class="id" type="var">tm_pred</span> <span class="id" type="var">t1</span>)) <span class="id" type="var">t2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t2</span> <span class="id" type="var">tm_false</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exists</span> <span class="id" type="var">u</span>, <span class="id" type="var">t1</span> = <span class="id" type="var">tm_succ</span> <span class="id" type="var">u</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">He1</span> <span class="id" type="var">He2</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">He1</span>. <span class="id" type="tactic">subst</span> <span class="id" type="var">t2</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">He2</span>. <span class="id" type="tactic">subst</span> <span class="id" type="var">t'</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H0</span>. <span class="id" type="tactic">exists</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t0</span>). <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">normal_form_if_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">normal_form</span> (<span class="id" type="var">tm_if</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">t1</span> &lt;&gt; <span class="id" type="var">tm_true</span> /\ <span class="id" type="var">t1</span> &lt;&gt; <span class="id" type="var">tm_false</span> /\ <span class="id" type="var">normal_form</span> <span class="id" type="var">t1</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span> <span class="id" type="var">Hnf</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">t1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">Hnf</span>. <span class="id" type="tactic">exists</span> <span class="id" type="var">t2</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">e_iftrue</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">Hnf</span>. <span class="id" type="tactic">exists</span> <span class="id" type="var">t3</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">e_iffalse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> [<span class="id" type="var">t'</span> <span class="id" type="var">He</span>]. <span class="id" type="tactic">destruct</span> <span class="id" type="var">Hnf</span>. <span class="id" type="tactic">exists</span> (<span class="id" type="var">tm_if</span> <span class="id" type="var">t'</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">e_if</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">He</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> [<span class="id" type="var">t'</span> <span class="id" type="var">He</span>]. <span class="id" type="tactic">inversion</span> <span class="id" type="var">He</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> [<span class="id" type="var">t'</span> <span class="id" type="var">He</span>]. <span class="id" type="tactic">destruct</span> <span class="id" type="var">Hnf</span>. <span class="id" type="tactic">exists</span> (<span class="id" type="var">tm_if</span> <span class="id" type="var">t'</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">e_if</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">He</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> [<span class="id" type="var">t'</span> <span class="id" type="var">He</span>]. <span class="id" type="tactic">destruct</span> <span class="id" type="var">Hnf</span>. <span class="id" type="tactic">exists</span> (<span class="id" type="var">tm_if</span> <span class="id" type="var">t'</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">e_if</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">He</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> [<span class="id" type="var">t'</span> <span class="id" type="var">He</span>]. <span class="id" type="tactic">destruct</span> <span class="id" type="var">Hnf</span>. <span class="id" type="tactic">exists</span> (<span class="id" type="var">tm_if</span> <span class="id" type="var">t'</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">e_if</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">He</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">full_eval_from_value_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">v</span> <span class="id" type="var">w</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">value</span> <span class="id" type="var">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">full_eval</span> <span class="id" type="var">v</span> <span class="id" type="var">w</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">v</span> = <span class="id" type="var">w</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">v</span> <span class="id" type="var">w</span> <span class="id" type="var">Hv</span> <span class="id" type="var">Hf</span>. <span class="id" type="tactic">induction</span> <span class="id" type="var">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">Hv</span> <span class="id" type="keyword">as</span> [ <span class="id" type="var">Hb</span> | <span class="id" type="var">Hn</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Hb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Hn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">Hv</span> <span class="id" type="keyword">as</span> [ <span class="id" type="var">Hb</span> | <span class="id" type="var">Hn</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Hb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Hn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> -&gt; <span class="id" type="var">IHHf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">right</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">value_succ_nvalue</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">Hv</span> <span class="id" type="keyword">as</span> [ <span class="id" type="var">Hb</span> | <span class="id" type="var">Hn</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Hb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Hn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">Hv</span> <span class="id" type="keyword">as</span> [ <span class="id" type="var">Hb</span> | <span class="id" type="var">Hn</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Hb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Hn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">Hv</span> <span class="id" type="keyword">as</span> [ <span class="id" type="var">Hb</span> | <span class="id" type="var">Hn</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Hb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Hn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">Hv</span> <span class="id" type="keyword">as</span> [ <span class="id" type="var">Hb</span> | <span class="id" type="var">Hn</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Hb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Hn</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">value_is_normal_form_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">value</span> <span class="id" type="var">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">normal_form</span> <span class="id" type="var">v</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">v</span> [ <span class="id" type="var">Hb</span> | <span class="id" type="var">Hn</span> ] [ <span class="id" type="var">t</span> <span class="id" type="var">He</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">Hb</span>; <span class="id" type="tactic">inversion</span> <span class="id" type="var">He</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">generalize</span> <span class="id" type="tactic">dependent</span> <span class="id" type="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">Hn</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">u</span> <span class="id" type="var">He</span>; <span class="id" type="tactic">inversion</span> <span class="id" type="var">He</span>; <span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<span class="id" type="var">IHHn</span> <span class="id" type="var">t'</span>). <span class="id" type="tactic">apply</span> <span class="id" type="var">H0</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <span class="id" type="var">eval_deterministic_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span class="id" type="var">t''</span>,<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">t''</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">t'</span> = <span class="id" type="var">t''</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span class="id" type="var">t''</span> <span class="id" type="var">He1</span>. <span class="id" type="tactic">generalize</span> <span class="id" type="tactic">dependent</span> <span class="id" type="var">t''</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">He1</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">t''</span> <span class="id" type="var">He2</span>; <span class="id" type="tactic">inversion</span> <span class="id" type="var">He2</span>; <span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">He1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">He1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> -&gt; (<span class="id" type="var">IHHe1</span> <span class="id" type="var">t1'0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> -&gt; (<span class="id" type="var">IHHe1</span> <span class="id" type="var">t'0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">normal_form</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span>)) <span class="id" type="keyword">as</span> <span class="id" type="var">Hnf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">nvalue_is_normal_form</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">n_succ</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">Hnf</span>. <span class="id" type="tactic">exists</span> <span class="id" type="var">t'</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">He1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">normal_form</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t''</span>)) <span class="id" type="keyword">as</span> <span class="id" type="var">Hnf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">nvalue_is_normal_form</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">n_succ</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">Hnf</span>. <span class="id" type="tactic">exists</span> <span class="id" type="var">t'</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">He1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> -&gt; (<span class="id" type="var">IHHe1</span> <span class="id" type="var">t'0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">normal_form</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span>)) <span class="id" type="keyword">as</span> <span class="id" type="var">Hnf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">nvalue_is_normal_form</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">n_succ</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">Hnf</span>. <span class="id" type="tactic">exists</span> <span class="id" type="var">t'</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">He1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">normal_form</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t0</span>)) <span class="id" type="keyword">as</span> <span class="id" type="var">Hnf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">nvalue_is_normal_form</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">n_succ</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">Hnf</span>. <span class="id" type="tactic">exists</span> <span class="id" type="var">t'</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">He1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> -&gt; (<span class="id" type="var">IHHe1</span> <span class="id" type="var">t'0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">H0</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">eval_full_eval_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eval</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">full_eval</span> <span class="id" type="var">t'</span> <span class="id" type="var">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">full_eval</span> <span class="id" type="var">t</span> <span class="id" type="var">v</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span class="id" type="var">v</span> <span class="id" type="var">He</span>. <span class="id" type="tactic">generalize</span> <span class="id" type="tactic">dependent</span> <span class="id" type="var">v</span>. <span class="id" type="tactic">induction</span> <span class="id" type="var">He</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">v</span> <span class="id" type="var">Hf</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">f_iftrue</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">f_value</span>. <span class="id" type="tactic">left</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">b_true</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">v</span> <span class="id" type="var">Hf</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">f_iffalse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">f_value</span>. <span class="id" type="tactic">left</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">b_false</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">v</span> <span class="id" type="var">Hf</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">f_iftrue</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHHe</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">f_iffalse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHHe</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">v</span> <span class="id" type="var">Hf</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">f_succ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">value_succ_nvalue</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHHe</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">f_value</span>. <span class="id" type="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">value_succ_nvalue</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">f_succ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHHe</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">v</span> <span class="id" type="var">Hf</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Hf</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">f_predzero</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">f_value</span>. <span class="id" type="tactic">right</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">n_zero</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">v</span> <span class="id" type="var">Hf</span>. <span class="id" type="tactic">assert</span> (<span class="id" type="var">t</span> = <span class="id" type="var">v</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">full_eval_from_value_sol</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">right</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span> <span class="id" type="var">v</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">f_predsucc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">f_succ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">v</span> <span class="id" type="var">Hf</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [ <span class="id" type="var">Hb</span> | <span class="id" type="var">Hn</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Hb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Hn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">f_predzero</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHHe</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">f_predsucc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHHe</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">v</span> <span class="id" type="var">Hf</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Hf</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">f_iszerozero</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">f_value</span>. <span class="id" type="tactic">right</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">n_zero</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">v</span> <span class="id" type="var">Hf</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">f_iszerosucc</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">v</span> := <span class="id" type="var">t</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">f_value</span>. <span class="id" type="tactic">right</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">n_succ</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">v</span> <span class="id" type="var">Hf</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [ <span class="id" type="var">Hb</span> | <span class="id" type="var">Hn</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Hb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Hn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">f_iszerozero</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHHe</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">f_iszerosucc</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">v</span> := <span class="id" type="var">v0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHHe</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H1</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">full_eval_complete_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">value</span> <span class="id" type="var">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">full_eval</span> <span class="id" type="var">t</span> <span class="id" type="var">v</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">v</span> <span class="id" type="var">Hv</span> <span class="id" type="var">Hm</span>. <span class="id" type="tactic">induction</span> <span class="id" type="var">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">f_value</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">eval_full_eval_sol</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">t'</span> := <span class="id" type="var">t'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHHm</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">Hv</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">pred_not_circular_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">t</span> &lt;&gt; <span class="id" type="var">tm_pred</span> <span class="id" type="var">t</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">induction</span> <span class="id" type="var">t</span>; <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">m_succ_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t</span>) (<span class="id" type="var">tm_succ</span> <span class="id" type="var">u</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span> <span class="id" type="var">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">Hm</span>; <span class="id" type="tactic">eauto</span> <span class="id" type="keyword">using</span> <span class="id" type="var">m_refl</span>, <span class="id" type="var">m_step</span>, <span class="id" type="var">e_succ</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">m_pred_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> (<span class="id" type="var">tm_pred</span> <span class="id" type="var">t</span>) (<span class="id" type="var">tm_pred</span> <span class="id" type="var">u</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">u</span> <span class="id" type="var">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">Hm</span>; <span class="id" type="tactic">eauto</span> <span class="id" type="keyword">using</span> <span class="id" type="var">m_refl</span>, <span class="id" type="var">m_step</span>, <span class="id" type="var">e_pred</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Fixpoint</span> <span class="id" type="var">interp</span> (<span class="id" type="var">t</span> : <span class="id" type="var">tm</span>) {<span class="id" type="keyword">struct</span> <span class="id" type="var">t</span>} : <span class="id" type="var">tm</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">t</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">tm_true</span> =&gt; <span class="id" type="var">tm_true</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">tm_false</span> =&gt; <span class="id" type="var">tm_false</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">tm_if</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">interp</span> <span class="id" type="var">t1</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">tm_true</span> =&gt; <span class="id" type="var">interp</span> <span class="id" type="var">t2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">tm_false</span> =&gt; <span class="id" type="var">interp</span> <span class="id" type="var">t3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">t4</span> =&gt; <span class="id" type="var">tm_if</span> <span class="id" type="var">t4</span> <span class="id" type="var">t2</span> <span class="id" type="var">t3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">tm_zero</span> =&gt; <span class="id" type="var">tm_zero</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">tm_succ</span> <span class="id" type="var">t1</span> =&gt; <span class="id" type="var">tm_succ</span> (<span class="id" type="var">interp</span> <span class="id" type="var">t1</span>)<br/>
&nbsp;&nbsp;| <span class="id" type="var">tm_pred</span> <span class="id" type="var">t1</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">interp</span> <span class="id" type="var">t1</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">tm_zero</span> =&gt; <span class="id" type="var">tm_zero</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">tm_succ</span> <span class="id" type="var">t2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">tm_to_nat</span> <span class="id" type="var">t2</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">some_nat</span> <span class="id" type="var">_</span> =&gt; <span class="id" type="var">t2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">no_nat</span> =&gt; <span class="id" type="var">tm_pred</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">t2</span> =&gt; <span class="id" type="var">tm_pred</span> <span class="id" type="var">t2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">tm_iszero</span> <span class="id" type="var">t1</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">interp</span> <span class="id" type="var">t1</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">tm_zero</span> =&gt; <span class="id" type="var">tm_true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">tm_succ</span> <span class="id" type="var">t2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">tm_to_nat</span> <span class="id" type="var">t2</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">some_nat</span> <span class="id" type="var">_</span> =&gt; <span class="id" type="var">tm_false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">no_nat</span> =&gt; <span class="id" type="var">tm_iszero</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">t2</span> =&gt; <span class="id" type="var">tm_iszero</span> <span class="id" type="var">t2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">tm_to_bool_dom_includes_bvalue_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">bv</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">bvalue</span> <span class="id" type="var">bv</span> -&gt; <span class="id" type="tactic">exists</span> <span class="id" type="var">b</span>, <span class="id" type="var">tm_to_bool</span> <span class="id" type="var">bv</span> = <span class="id" type="var">some_bool</span> <span class="id" type="var">b</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">bv</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">exists</span> <span class="id" type="var">true</span>. <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">exists</span> <span class="id" type="var">false</span>. <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">tm_to_bool_dom_only_bvalue_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">bv</span> <span class="id" type="var">b</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">tm_to_bool</span> <span class="id" type="var">bv</span> = <span class="id" type="var">some_bool</span> <span class="id" type="var">b</span> -&gt; <span class="id" type="var">bvalue</span> <span class="id" type="var">bv</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">bv</span> <span class="id" type="var">b</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">bv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">b_true</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">b_false</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">tm_to_nat_dom_includes_nvalue_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">v</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">nvalue</span> <span class="id" type="var">v</span> -&gt; <span class="id" type="tactic">exists</span> <span class="id" type="var">n</span>, <span class="id" type="var">tm_to_nat</span> <span class="id" type="var">v</span> = <span class="id" type="var">some_nat</span> <span class="id" type="var">n</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">v</span> <span class="id" type="var">Hnv</span>. <span class="id" type="tactic">induction</span> <span class="id" type="var">Hnv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">exists</span> <span class="id" type="var">O</span>. <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">IHHnv</span> <span class="id" type="keyword">as</span> [ <span class="id" type="var">n</span> <span class="id" type="var">Heq</span> ]. <span class="id" type="tactic">exists</span> (<span class="id" type="var">S</span> <span class="id" type="var">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">rewrite</span> -&gt; <span class="id" type="var">Heq</span>. <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">tm_to_nat_dom_only_nvalue_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">v</span> <span class="id" type="var">n</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">tm_to_nat</span> <span class="id" type="var">v</span> = <span class="id" type="var">some_nat</span> <span class="id" type="var">n</span> -&gt; <span class="id" type="var">nvalue</span> <span class="id" type="var">v</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">v</span>. <span class="id" type="tactic">induction</span> <span class="id" type="var">v</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">n</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">n_zero</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">n_succ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">destruct</span> (<span class="id" type="var">tm_to_nat</span> <span class="id" type="var">v</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">eapply</span> <span class="id" type="var">IHv</span>. <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">interp_reduces_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">eval_many</span> <span class="id" type="var">t</span> (<span class="id" type="var">interp</span> <span class="id" type="var">t</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span>. <span class="id" type="tactic">induction</span> <span class="id" type="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_refl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_refl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">destruct</span> (<span class="id" type="var">interp</span> <span class="id" type="var">t1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <span class="id" type="var">m_trans</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_if</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHt1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <span class="id" type="var">m_trans</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <span class="id" type="var">m_one</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">e_iftrue</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHt2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <span class="id" type="var">m_trans</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_if</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHt1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <span class="id" type="var">m_trans</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <span class="id" type="var">m_one</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">e_iffalse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHt3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_if</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHt1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_if</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHt1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_if</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHt1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_if</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHt1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_if</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHt1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_refl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">m_succ</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">destruct</span> (<span class="id" type="var">interp</span> <span class="id" type="var">t</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_pred</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_pred</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_pred</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <span class="id" type="var">m_trans</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_pred</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_one</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">e_predzero</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">remember</span> (<span class="id" type="var">tm_to_nat</span> <span class="id" type="var">t0</span>) <span class="id" type="keyword">as</span> <span class="id" type="var">x</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <span class="id" type="var">m_trans</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_pred</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_one</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">e_predsucc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <span class="id" type="var">tm_to_nat_dom_only_nvalue</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">Heqx</span>. <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_pred</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_pred</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_pred</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">destruct</span> (<span class="id" type="var">interp</span> <span class="id" type="var">t</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_iszero</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_iszero</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_iszero</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <span class="id" type="var">m_trans</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_iszero</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_one</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">e_iszerozero</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">remember</span> (<span class="id" type="var">tm_to_nat</span> <span class="id" type="var">t0</span>) <span class="id" type="keyword">as</span> <span class="id" type="var">x</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <span class="id" type="var">m_trans</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_iszero</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_one</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">e_iszerosucc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <span class="id" type="var">tm_to_nat_dom_only_nvalue</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">Heqx</span>. <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_iszero</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_iszero</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">m_iszero</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHt</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">interp_fully_reduces_sol</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">normal_form</span> (<span class="id" type="var">interp</span> <span class="id" type="var">t</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">t</span>; <span class="id" type="tactic">intros</span> [<span class="id" type="var">t'</span> <span class="id" type="var">H</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">destruct</span> (<span class="id" type="var">interp</span> <span class="id" type="var">t1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">IHt2</span>. <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">IHt3</span>. <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">IHt1</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">IHt1</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">IHt1</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">IHt1</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">IHt1</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">IHt</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">destruct</span> (<span class="id" type="var">interp</span> <span class="id" type="var">t</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">IHt</span>. <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">remember</span> (<span class="id" type="var">tm_to_nat</span> <span class="id" type="var">t0</span>) <span class="id" type="keyword">as</span> <span class="id" type="var">x</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">IHt</span>. <span class="id" type="tactic">exists</span> (<span class="id" type="var">tm_succ</span> <span class="id" type="var">t'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">e_succ</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<span class="id" type="var">tm_to_nat_dom_includes_nvalue</span> <span class="id" type="var">t'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">as</span> [<span class="id" type="var">n</span> <span class="id" type="var">Heq</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">Heqx</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">IHt</span>. <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">IHt</span>. <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">IHt</span>. <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">destruct</span> (<span class="id" type="var">interp</span> <span class="id" type="var">t</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">IHt</span>. <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">remember</span> (<span class="id" type="var">tm_to_nat</span> <span class="id" type="var">t0</span>) <span class="id" type="keyword">as</span> <span class="id" type="var">x</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<span class="id" type="var">tm_to_nat_dom_includes_nvalue</span> <span class="id" type="var">t0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">as</span> [<span class="id" type="var">n</span> <span class="id" type="var">Heq</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">Heqx</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Heq</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">IHt</span>. <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">IHt</span>. <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">IHt</span>. <span class="id" type="tactic">eauto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>